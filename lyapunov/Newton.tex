\ifsvnmulti
 \svnkwsave{$RepoFile: siminos/lyapunov/Newton.tex $}
 \svnidlong {$HeadURL: svn://zero.physics.gatech.edu/siminos/lyapunov/Newton.tex $}
 {$LastChangedDate: 2016-11-06 14:59:33 -0500 (Sun, 06 Nov 2016) $}
 {$LastChangedRevision: 5325 $} {$LastChangedBy: predrag $}
 \svnid{$Id: Newton.tex 5325 2016-11-06 19:59:33Z predrag $}
\fi

\renewcommand{\ssp}{x}            % state space point

\section{{\PoincSec s}}
\label{s:PoincSect}
% Predrag							 5mar2011
% extracted from ChaosBook.org 		13jun2008
% \Chapter{maps}}{Discrete time dynamics}

\noindent Successive trajectory intersections with a {\em {\PoincSec}}, a
$(d-1)$-dim\-ens\-ion\-al hypersurface or a set of hypersurfaces
$\PoincS$ embedded in the $d$-dim\-ens\-ion\-al {\statesp} $\pS$, define
the {\em {\Poincare} return map} $\PoincM({\ssp})$, a
$(d-1)$-dim\-ens\-ion\-al map of form \beq \ssp' = \PoincM({\ssp})
          =  \flow{\tau(\ssp)}{\ssp}
\,,\qquad \ssp', \ssp \in \PoincS \,. \ee{PoincMap} Here the {\em first
return function} $\tau(\ssp)$--sometimes referred to as the {\em ceiling
function}--is the time of flight to the next section for a trajectory
starting at $\ssp$. The choice of the section hypersurface $\PoincS$ is
altogether arbitrary, but in practice one often needs only a local
section--a hyperplane of codimension~1 intersected by a swarm of
trajectories near to the trajectory of interest. This hyperplane can be
specified implicitly through a function $\PoincC(\ssp)$ that is zero
whenever a point $\ssp$ is on the {\PoincSec},
  \beq
\ssp \in \PoincS \quad \mbox{iff}
\quad \PoincC(\ssp) = 0 \,.
  \ee{PoincU}

First, the flow should pierce the
hypersurface $\PoincS$, rather than being tangent to it. A
nearby point $\ssp + \delta\ssp$ is in the hypersurface
$\PoincS$ if $\PoincC(\ssp+ \delta\ssp)=0$. A nearby point on
the trajectory is given by $\delta\ssp = \vel \delta t$, so a
traversal is ensured by the {\em transversality condition}
\beq
    (\vel \cdot \pde\PoincC) =
    \sum_{j=1}^{d}
    \vel_j(\ssp) \, \pde_j \PoincC(\ssp) \neq 0
\,,\quad
    \pde_j \PoincC(\ssp) =
    \frac{\partial~}{\partial \ssp_j} \PoincC(\ssp)
\,,\quad
    \ssp \in \PoincS
\,.
\ee{transvrCond}
Second, the definition of {{\Poincare} return
map} $\PoincM({\ssp})$ needs to be supplemented
with the orientation condition
\bea
\ssp_{n+1} = \PoincM({\ssp_n}) \,,\qquad &&
\PoincC(\ssp_{n+1}) = \PoincC(\ssp_{n})   = 0 \,,\quad n \in
\integers^{+} \continue
 &&
  \sum_{j=1}^{d} \vel_j(\ssp_{n}) \, \pde_j \PoincC(\ssp_{n}) \,>\, 0
\,.
\label{orientCond}
\eea
In this way the continuous time $t$ flow $
\flow{t}{\ssp}$ is reduced to a discrete time $n$ sequence
$\ssp_n$ of successive {\em oriented} trajectory traversals of
$\PoincS$.


With a sufficiently clever choice of a {\PoincSec} or a set of sections,
any orbit of interest intersects a section.

\section{Symbolic dynamics, basic notions}
\label{s-SymbDynDefs}
% extracted from ChaosBook knead.tex {Charting the state space}
%  predrag 2010-09-24 11:36:21 -0400 (Fri, 24 Sep 2010) $

This section is excerpted from ChaosBook.org
chapter
\HREF{http://ChaosBook.org/chapters/knead.pdf}
{Charting the state space}.

\noindent{\bf Shifts.}
We associate with every  initial point $\xInit \in \pS$
the {\em future itinerary},
\index{itinerary!future}
a sequence of symbols
$\Sfuture(\xInit)=\Ssym{1} \Ssym{2} \Ssym{3} \cdots$
which indicates the order in which the regions are visited.
If the trajectory $x_1,  x_2,  x_3,  \ldots$
of the initial point $\xInit$ is generated by
\beq
   x_{n+1}=f(x_n)
    % \,, \quad x_0=\xInit
\,,
\ee{e-x-iterated}
then the itinerary is given by the symbol sequence
\beq
   \Ssym{n} = \Ssym{} \qquad \mbox{if\ } \qquad  x_n \in \pS_{\Ssym{}}
 \,.
\ee{e-symbol-def}
Similarly, the {\em past itinerary}
\index{itinerary!past}
$\Spast(\xInit)=\cdots\Ssym{-2} \Ssym{-1} \Ssym{0} $
describes the history of $\xInit$, the order in which
the regions were visited before arriving to the point $\xInit$.
To each point $\xInit$ in the dynamical space we thus associate
a bi-infinite itinerary
\index{bi-infinite itinerary}
\index{itinerary!bi-infinite}
\beq
\Sbiinf(\xInit) = (\Ssym{k})_{k\in \integers}
        = \Spast.\Sfuture  =
 \biinf{\Ssym{-2}\Ssym{-1}\Ssym{0}}{\Ssym{1}\Ssym{2} \Ssym{3}}
\,.
\label{biifs}
\eeq
The itinerary will be finite for a scattering trajectory,
entering and then escaping $\pS$ after a finite time,
infinite for a trapped trajectory,
and infinitely repeating for a periodic trajectory.

The set of all bi-infinite itineraries that can be formed from the
letters of the alphabet ${\cal A}$ is called the
{\em full shift} (or {\em topological Markov chain})
\index{shift!full}
\beq
{\cal A}^\integers = \{ (\Ssym{k})_{k\in \integers}
              : \Ssym{k} \in {\cal A} \mbox{~for all k~} \in  \integers \}
\,.
\ee{FullSh}
We refer to this set of all conceivable itineraries
as the {\em covering} symbolic dynamics.
\index{symbolic dynamics!covering}
\index{covering!symbolic dynamics}
The name {\em shift}\index{shift} is descriptive of the way
the dynamics acts on these sequences.
As is clear from the definition \refeq{e-symbol-def},
a forward iteration $x\rightarrow x' = f(x)$ shifts the
entire itinerary to the left through the `decimal point.'
This operation, denoted by the shift operator $\sigma$,
\index{shift!operator}
\index{operator!shift}
\beq
   \sigma(\biinf{\Ssym{-2}\Ssym{-1}\Ssym{0}}{\Ssym{1}\Ssym{2} \Ssym{3}})
     =  \biinf{ \Ssym{-2}\Ssym{-1}\Ssym{0}\Ssym{1}}{ \Ssym{2} \Ssym{3}}
\,,
\label{e-shift-s}
\eeq
demoting the current partition label $\Ssym{1}$
from the future $\Sfuture$ to the `has been' itinerary $\Spast$.
The inverse shift $\sigma^{-1}$ shifts the entire itinerary one step
to the right.

A finite sequence $b={ \Ssym{k} \Ssym{k+1} \cdots \Ssym{k+\cl{b}-1}}$
of symbols from ${\cal A}$ is called a {\em block}
of length $\cl{b}$. If the symbols outside of the block remain
unspecified, we denote to the totality of orbits that
share this block by
$\prune{\Ssym{k} \Ssym{k+1} \cdots \Ssym{k+\cl{b}-1}}$.

A {\statesp} orbit is {\em periodic} if it returns to
its initial point after a finite time;
in the shift space the orbit is periodic if
its itinerary is an infinitely repeating block
$p^\infty$.
We shall refer to the set of periodic points $\pS_p$ that
\index{point!periodic}
\index{periodic!point}
belong to a given periodic orbit
\index{periodic!orbit}
\index{orbit!periodic}
as a {\em cycle}
%\index{cycle}
\beq
p =  \cycle{ \Ssym{1} \Ssym{2} \cdots \Ssym{\cl{p}}}
  = \{
      x_{ \Ssym{1} \Ssym{2}\cdots \Ssym{\cl{p}}},
      x_{ \Ssym{2} \cdots \Ssym{\cl{p}} \Ssym{1}},
    \cdots,
      x_{ \Ssym{\cl{p}} \Ssym{1}\cdots \Ssym{\cl{p}-1}}
     \}
\,.
\ee{PeriodCyc}
By its definition, a cycle is invariant under cyclic permutations
of the symbols in the repeating block.
A bar over a finite block of symbols denotes a periodic
itinerary with infinitely  repeating basic block;
we shall omit the bar whenever
it is clear from the context that the orbit is periodic.
Each {\em periodic point} is labeled by the first $\cl{p}$
steps of its future
itinerary. For example, the 2nd periodic point is labeled by
\[
      x_{ \Ssym{2} \cdots \Ssym{\cl{p}} \Ssym{1}}
    =
x_{ \cycle{ \Ssym{2} \cdots \Ssym{\cl{p}} \Ssym{1} }
    \cdot
    \cycle{ \Ssym{2} \cdots \Ssym{\cl{p}} \Ssym{1}} }
\,.
\]
A {\em prime} cycle
\index{prime cycle}
\index{cycle!prime}
$p$ of length ${\cl{p}}$ is a single traversal of the orbit;
its label is a block of $\cl{p}$ symbols that cannot be written as
a repeat of a shorter block (in literature such cycle is sometimes
called {\em primitive};
%\index{prime cycle; see prime cycle}
we shall refer to it
as `prime' throughout this text).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
\caption[]{\small
All prime cycles up to period 10
for the H\'enon map, $a=1.4$ and $b=0.3$.
The columns list the period $\cl{p}$, the itinerary,
(defined in \refrem{r-HenSymbDyn}),
% \cite{biham_wenzel_89}
a periodic point $(y_p,x_p)$, and the cycle
Lyapunov exponent $\Lyap_p=\ln|\ExpaEig_p|/\cl{p}$. While
most of the cycles have $\Lyap_p \approx 0.5$, several significantly
do not. The \cycle{0} periodic point is very unstable, isolated and
transient fixed point, with no other cycles returning close to it.
At period 13 one finds
a pair of cycles with exceptionally low Lyapunov exponents.
The cycles are close for most of the trajectory, differing only
in the one symbol corresponding to two periodic points straddle
the (partition) fold of the attractor.
As the system is not hyperbolic, there is no known
lower bound on cycle Lyapunov exponents, and the H\'enon's strange
``attractor'' might some day turn out to be nothing but
a transient on the way to a periodic attractor of some long
period%
%(Work through \refexer{e_Hen_13})%
.
%The odds, however, are that it indeed is strange.
}
\renewcommand{\arraystretch}{0.7}
{\small
\begin{center}
\begin{tabular}{rlr@{~,~}lr}
\hline
 $\cl{}$~ &~~~~$p$ & $(~y_p$&$x_p~)$~~~~~~~~ & $\Lyap_p$~~~~~ \\ \hline
 1 & 0 &        (-1.13135447&-1.13135447)   &    1.18167262 \\
   & 1 &         (0.63135447&0.63135447)    &   0.65427061 \\
   %\hline
 2 & 01 &         (0.97580005&-0.47580005)    &   0.55098676 \\
   %\hline
 4 & 0111 &        (-0.70676677&0.63819399)   &    0.53908457 \\
   %\hline
 6 & 010111 &        (-0.41515894&1.07011813)   &    0.55610982 \\
  & 011111  &        (-0.80421990&0.44190995)    &   0.55245341 \\
   %\hline
 7 &  0011101 &        (-1.04667757&-0.17877958)    &   0.40998559    \\
   &  0011111 &         (-1.08728604&-0.28539206)    &   0.46539757     \\
   &  0101111 &         (-0.34267842&1.14123046)    &   0.41283650    \\
   &  0111111 &         (-0.88050537&0.26827759)    &  0.51090634    \\
   %\hline
 8 & 00011101 &        (-1.25487963&-0.82745422)   &    0.43876727     \\
   & 00011111 &        (-1.25872451&-0.83714168)   &   0.43942101      \\
   & 00111101 &        (-1.14931330&-0.48368863)   &    0.47834615     \\
   & 00111111 &        (-1.14078564&-0.44837319)   &    0.49353764     \\
   & 01010111 &        (-0.52309999&0.93830866)   &    0.54805453     \\
   & 01011111 &        (-0.38817041&1.09945313)   &    0.55972495     \\
   & 01111111 &        (-0.83680827&0.36978609)   &    0.56236493    \\
   %\hline
 9 & 000111101  &        (-1.27793296&-0.90626780)  &     0.38732115    \\
   & 000111111  &        (-1.27771933&-0.90378859)  &     0.39621864   \\
   & 001111101  &        (-1.10392601&-0.34524675)  &     0.51112950     \\
   & 001111111  &        (-1.11352304&-0.36427104)  &     0.51757012    \\
   & 010111111  &        (-0.36894919&1.11803210)  &     0.54264571    \\
   & 011111111  &        (-0.85789748&0.32147653)  &     0.56016658    \\
   %\hline
 10 & 0001111101 &       (-1.26640530&-0.86684837)   &    0.47738235     \\
    & 0001111111 &       (-1.26782752&-0.86878943)   &    0.47745508      \\
    & 0011111101 &        (-1.12796804&-0.41787432)   &    0.52544529      \\
    & 0011111111 &        (-1.12760083&-0.40742737)   &    0.53063973     \\
    & 0101010111 &        (-0.48815908&0.98458725)   &    0.54989554      \\
    & 0101011111 &        (-0.53496022&0.92336925)   &    0.54960607      \\
    & 0101110111 &        (-0.42726915&1.05695851)   &    0.54836764      \\
    & 0101111111 &        (-0.37947780&1.10801373)  &     0.56915950   \\
    & 0111011111 &        (-0.69555680&0.66088560)   &    0.54443884   \\
    & 0111111111 &        (-0.84660200&0.34750875)   &    0.57591048   \\
   %\hline
13  & 1110011101000   &  (-1.2085766485&-0.6729999948)  &  0.19882434  \\
    & 1110011101001   &  (-1.0598110494&-0.2056310390)  &  0.21072511  \\
   \hline
\end{tabular}
\end{center}
}
\renewcommand{\arraystretch}{1.0}
\label{t-biham2}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\remark{Relation to the Smale horseshoe symbolic dynamics.}{
\label{r-HenSymbDyn}
For a complete horseshoe H\'enon repeller ($a$ sufficiently large),
such as the one given in \reffig{FigBiham1},
the signs $\Ksym{i} \in \{1,-1\}$
are in a 1-to-1 correspondence
with the Smale horsheshoe symbolic dynamics $\Ssym{i} \in \{0,1\}$:
\beq
   \Ssym{i} = \left\{
             \begin{array}{ll}
               0  & \mbox{if\ } \Ksym{i} = -1\,, \quad x_i <0 \\
               1  & \mbox{if\ } \Ksym{i} = +1\,, \quad x_i >0
             \end{array}
               \right.
\,.
\label{SmHors}
\eeq
For arbitrary parameter values with a
finite subshift symbolic dynamics or
with arbitrarily complicated pruning, the relation of sign sequences
$\{\Ksym{1},\Ksym{2}, \cdots,\Ksym{\cl{}}\}$
to the itineraries
$\{\Ssym{1},\Ssym{2}, \cdots,\Ssym{\cl{}}\}$
can be much subtler; this is discussed in
\refref{GK85}.
} %end\remark{Relation to the Smale horsheshoe symbolic dynamics.}{



\section{Newton method for flows}
\label{s-POs-flows}
% Predrag extracted							05mar2011
% from ChaosBook.org \Chapter{cycles}{Fixed points, and ...}
% Predrag edits  							26sep2008

% \authorRPPC

{\bf Predrag 2011-03-05}
{This appendix is copied from ChaosBook.org - the edits here will
eventually be returned back to ChaosBook.org. Please keep ChaosBook
formatting throughout this chapter. Thanks!}

\noindent
For a continuous time flow the periodic orbit Floquet
multiplier
% \refeq{MargEigParall}
along the flow direction of
necessity equals unity; the separation of any two points along
a cycle remains unchanged after a completion of the cycle.
% \toSect{s:MargEigs}
More unit Floquet multipliers arise if the
flow satisfies conservation laws, such as the symplectic
invariance for Hamiltonian flows, or the dynamics is equivariant
under a continuous symmetry transformation.
% \toSect{s:StabRpo}
% \index{Newton method!flows}

Let us apply the Newton method of
% \refeq{NewtIt}
to search for
periodic orbits with unit Floquet multipliers,
starting with the case of a \emph{continuous time
flow}. Assume that the periodic orbit condition
% \refeq{e:periodic}
holds for $\ssp+\Delta\ssp$ and
$\period{}+\Delta t$, with the initial guesses $\ssp$ and
$\period{}$ close to the desired solution, \ie, with
$|\Delta\ssp|$, $\Delta t$ small. The Newton setup
% \refeq{NewtIt}
\bea
0 &=& \ssp+\Delta\ssp - f^{\period{}+\Delta t}(\ssp+\Delta\ssp)
  \continue
  &\approx&
\ssp - f^{\period{}}(\ssp) + (1 - \jMps(\ssp))\cdot\Delta\ssp
- \vel(f^{\period{}}(\ssp))\Delta t
\label{NewtonVarFlow}
\eea
suffers from two shortcomings. First, we now need to solve not
only for the periodic point $\ssp$, but for the period
$\period{}$ as well. Second, the marginal, unit Floquet
multiplier
% \refeq{MargEigParall}
along the flow direction
(arising from the time-translation invariance of a \po) renders
the factor $(1-\jMps)$ in
\refeq{NewtonVarFlow} % \refeq{NewtItMap}
non-invertible: if $\ssp$ is close to the solution,
$f^\period{}(\ssp)\approx \ssp$, then
$\jMps(\ssp)\cdot\vel(\ssp)=
\vel(f^\period{}(\ssp))\approx \vel(\ssp)$. If $\Delta\ssp$ is
parallel to the velocity vector, the derivative term
$(1-\jMps)\cdot\Delta\ssp\approx 0$, and it becomes harder to invert
$(1-\jMps)$ as the iterations approach the solution.

As a periodic orbit $p$ is a 1\dmn\ set of points invariant
under dynamics, Newton guess is not improved by picking
$\Delta\ssp$ such that the new point lies on the orbit
of the initial one, so we need to constrain the variation
$\Delta\ssp$ to directions transverse to the flow, by requiring,
for example, that
\PC{In remark explain that Davidchack inverts it anyway,
    without a constraint}
\beq
    \vel(\ssp) \cdot \Delta\ssp = 0
\,.
\ee{locTransvVar}
Combining this constraint with the variational condition
\refeq{NewtonVarFlow} we obtain a Newton setup for flows, best
displayed in the matrix form:
	\PC{bottom left corner is dimensionally wrong?
		it should be $1/[\vel]$?}
\beq
\MatrixII{1-\jMps(\ssp)}{\vel(\ssp)}{\vel(\ssp)}{0}
\left(\begin{array}{c}
    \Delta\ssp \\
    \Delta t
  \end{array}\right) =-
\left(\begin{array}{c}
    \ssp-f(\ssp)\\
    0
  \end{array}\right)
\ee{e:veq-1}
This illustrates the general strategy for determining \po s in
presence of continuous symmetries - for each symmetry, break
the invariance by a constraint, and compute the value of the
corresponding continuous parameter (here the period
$\period{}$) by iterating the enlarged set of Newton equations.
Constraining the variations to transverse ones thus fixes both
of Newton's shortcomings: it breaks the time-translation
invariance, and the period $\period{}$ can be read off once the
fixed point has been found (hence we omit the superscript
in $f{}^\period{}$ for the remainder of this discussion).

More generally, the {\Poincare} surface of section technique
% of \refsect{s:PoincSect}
turns the periodic orbit search into a
fixed point search on a suitably defined surface of section,
with a neighboring point variation $\Delta\ssp$ with respect to
a reference point  $\ssp$ constrained to \emph{stay} on the
surface manifold
%  \refeq{PoincU},
\beq
\PoincC( \ssp+\Delta\ssp) = \PoincC (\ssp) =0
\,.
\ee{e:pscond}
The price to pay are constraints imposed by the section: in
order to \emph{stay} on the surface, arbitrary variation
$\Delta\ssp$ is not allowed.
