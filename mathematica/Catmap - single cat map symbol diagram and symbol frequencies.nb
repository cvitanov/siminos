(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91359,       2500]
NotebookOptionsPosition[     79868,       2334]
NotebookOutlinePosition[     80215,       2349]
CellTagsIndexPosition[     80172,       2346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Introduction", "Section",
 CellChangeTimes->{{3.676154497211738*^9, 
  3.6761544991799173`*^9}},ExpressionUUID->"9ba479c6-e91b-4012-a66b-\
85d07147ca64"],

Cell["\<\
In this notebook we study the state space symbol diagram and symbol \
boundaries of the single cat map, which are in analogous to phase diagram and \
phase boundaries of matter. As the cat map is invertible and area-preserving, \
it has uniform invariant density and we can study the symbol occuring \
frequencies from the areas on the symbol diagram.\
\>", "Text",
 CellChangeTimes->{{3.6761547783674097`*^9, 3.676154866772333*^9}, {
  3.676329160218404*^9, 
  3.676329267803919*^9}},ExpressionUUID->"35cd8adf-e56b-44dc-b70c-\
68dbe515b4d6"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.6744667513768253`*^9, 
  3.674466754304716*^9}},ExpressionUUID->"b995870a-50b1-445e-82dd-\
087672553304"],

Cell[TextData[{
 "The cat map, its inverse map, and symbol ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "t"], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["m", "t"], "[", 
          RowBox[{"{", "q", "}"}], "]"}]},
        {
         RowBox[{
          SubscriptBox["m", "t"], "[", 
          RowBox[{"{", "p", "}"}], "]"}]}
       }], ")"}], "\[Congruent]", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubscriptBox["q", 
           RowBox[{"t", "-", "1"}]], "-", 
          RowBox[{
           RowBox[{"Tr", "[", "A", "]"}], " ", 
           SubscriptBox["q", "t"]}], "+", 
          SubscriptBox["q", 
           RowBox[{"t", "+", "1"}]]}]},
        {
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"t", "-", "1"}]], "-", 
          RowBox[{
           RowBox[{"Tr", "[", "A", "]"}], " ", 
           SubscriptBox["p", "t"]}], "+", 
          SubscriptBox["p", 
           RowBox[{"t", "+", "1"}]]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "965af79c-e2a2-46d8-b373-d5ad67922bfb"],
 ":"
}], "Text",
 CellChangeTimes->{{3.67615349033328*^9, 3.676153528629223*^9}, {
  3.676153803004115*^9, 3.676153833773672*^9}, {3.676153902819072*^9, 
  3.676154065481134*^9}, {3.676154577370338*^9, 3.6761545812855167`*^9}, {
  3.6762004368370533`*^9, 
  3.676200440875978*^9}},ExpressionUUID->"5e0d22b0-d958-4166-85ef-\
bdd0cdec41e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"AI", "=", 
   RowBox[{"Inverse", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", ":=", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"A", ".", "#"}], ",", "1"}], "]"}], "&"}]}], ";", 
  RowBox[{"fI", ":=", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"AI", ".", "#"}], ",", "1"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", "r0_", "]"}], ":=", 
   RowBox[{
    RowBox[{"fI", "[", "r0", "]"}], "-", 
    RowBox[{
     RowBox[{"Tr", "[", "A", "]"}], " ", "r0"}], "+", 
    RowBox[{"f", "[", "r0", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.672524311864152*^9, {3.674414755457843*^9, 3.674414755929764*^9}, {
   3.674507684289502*^9, 3.674507687338406*^9}, {3.6745667347992287`*^9, 
   3.67456673905195*^9}, {3.674566771711388*^9, 3.674566774141432*^9}, {
   3.676153487139113*^9, 3.6761534872970133`*^9}, 3.676153746031233*^9, {
   3.676153811900063*^9, 
   3.676153813969863*^9}},ExpressionUUID->"1524c4b7-1bd6-4e44-acec-\
f68478c6b47b"],

Cell[TextData[{
 "Either ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "t"], "[", 
    RowBox[{"{", "q", "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "c64836fa-c5c3-4d89-971c-2d5a88d13329"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "t"], "[", 
    RowBox[{"{", "p", "}"}], "]"}], TraditionalForm]],ExpressionUUID->
  "00e23ec8-7127-4b97-be5e-2bcc06fde9c3"],
 " will encode the full information about the dynamics, and from one of them \
we can derive the other. In the above definition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["r", "0"], "=", 
    RowBox[{"{", 
     RowBox[{"q", ",", "p"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "dd2910d0-5194-46a1-8c60-3a3da936e8a5"],
 " is the state space vector."
}], "Text",
 CellChangeTimes->{{3.6761545856403837`*^9, 3.6761546655079527`*^9}, {
  3.67621260486694*^9, 
  3.676212619502907*^9}},ExpressionUUID->"ec21f4f7-e168-42f2-9e2e-\
e99ff3f9b023"],

Cell[TextData[{
 "The region \[OpenCurlyDoubleQuote]modulus\[CloseCurlyDoubleQuote] function \
that generates the new region under the map ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"q", ",", "p"}], ")"}], "\[RightTeeArrow]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"q", ",", "1"}], "]"}], ",", 
      RowBox[{"Mod", "[", 
       RowBox[{"p", ",", "1"}], "]"}]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"114f9615-4fce-4a64-9b5a-5539fe2b470a"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6763293683137903`*^9, 3.6763294770371227`*^9}, {
  3.676329512013434*^9, 
  3.676329515635868*^9}},ExpressionUUID->"363fbc3c-0008-43aa-a7bd-\
3d2f441d0014"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SquarePolygon01", "[", "p_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x0", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"p", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"x1", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"p", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"y0", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"p", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"y1", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"p", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ",", "rs", ",", 
       "ps", ",", "ms"}], "}"}], ",", 
     RowBox[{
      RowBox[{"rs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Outer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Floor", "[", "x0", "]"}], ",", 
             RowBox[{
              RowBox[{"Ceiling", "[", "x1", "]"}], "-", "1"}]}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Floor", "[", "y0", "]"}], ",", 
             RowBox[{
              RowBox[{"Ceiling", "[", "y1", "]"}], "-", "1"}]}], "]"}]}], 
          "]"}], ",", "1"}], "]"}]}], ";", 
      RowBox[{"ps", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RegionIntersection", "[", 
          RowBox[{
           RowBox[{"Polygon", "[", "p", "]"}], ",", 
           RowBox[{"Rectangle", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
        "rs"}]}], ";", 
      RowBox[{"ms", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"RegionDimension", "/@", "ps"}], ",", "2"}], "]"}], "//", 
        "Flatten"}]}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{"TransformedRegion", "[", 
         RowBox[{
          RowBox[{"ps", "[", 
           RowBox[{"[", 
            RowBox[{"ms", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"TranslationTransform", "[", 
           RowBox[{"-", 
            RowBox[{"rs", "[", 
             RowBox[{"[", 
              RowBox[{"ms", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}],
         "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "ms", "]"}], "]"}]}]}]}], "]"}]}], 
  ";"}]], "Input",ExpressionUUID->"a48bfe8c-9dae-4c64-9b98-ec66ddc2a4ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Usage and test", "Subsection",
 CellChangeTimes->{{3.67615450604268*^9, 
  3.676154512140285*^9}},ExpressionUUID->"82372330-ae7e-488b-877e-\
c27495a97ee4"],

Cell["\<\
A simple test (initial condition lies on a length-10 periodic orbit):\
\>", "Text",
 CellChangeTimes->{{3.6761536170787992`*^9, 3.676153620993874*^9}, {
  3.676154112080299*^9, 3.6761541428944807`*^9}, {3.676154539984785*^9, 
  3.676154553271215*^9}, {3.676154703070038*^9, 
  3.676154750905642*^9}},ExpressionUUID->"c060453b-2d9a-448b-90e3-\
29cccb2d7098"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "5"], ",", 
     FractionBox["3", "5"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NestList", "[", 
  RowBox[{"f", ",", "r0", ",", "30"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Position", "[", 
  RowBox[{"%", ",", "r0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"m", "/@", "%%"}]}], "Input",
 CellChangeTimes->{{3.674565651379211*^9, 3.674565711996825*^9}, {
  3.6761536029716177`*^9, 3.676153603074057*^9}, {3.676154090188442*^9, 
  3.676154127920388*^9}, {3.676154518159433*^9, 
  3.676154550110285*^9}},ExpressionUUID->"84b95c5b-7960-4f5c-958b-\
d1b968cb57c3"],

Cell[TextData[{
 "Usage of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"SquarePolygon01", "[", "]"}], TraditionalForm]],ExpressionUUID->
  "c4da3024-f9af-45c3-a0d3-85b17d2d01d9"],
 " function: it takes the vertex coordinates of a polygon, and returns the \
image of the polygon under the modulus 1 action (cut and translate into unit \
square ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"[", 
       RowBox[{"0", ",", "1"}]}], ")"}], "\[Times]", 
     RowBox[{"[", 
      RowBox[{"0", ",", "1"}]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "250d6c5f-a250-415a-a987-5a7168274121"],
 ")."
}], "Text",
 CellChangeTimes->{{3.6763298206193733`*^9, 3.676329827721521*^9}, {
  3.67632991590329*^9, 3.6763299174313107`*^9}, {3.6763299948210363`*^9, 
  3.676330105765812*^9}},ExpressionUUID->"64fbe84d-874b-475c-8966-\
b0f0c7856a62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["7", "3"], ",", 
       FractionBox["3", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       FractionBox["5", "3"]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p01", "=", 
  RowBox[{"SquarePolygon01", "[", "p0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"RegionPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Polygon", "[", "p0", "]"}], ",", "%"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"3", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "10"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "10"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Area", "/@", "p01"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"%", "//", "Total"}], ",", 
   RowBox[{"Area", "[", 
    RowBox[{"Polygon", "[", "p0", "]"}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.6763299193783703`*^9, 3.676329973325333*^9}, {
  3.676330126616867*^9, 3.676330270548984*^9}, {3.676330325507276*^9, 
  3.6763303362662*^9}, {3.676330368055037*^9, 
  3.676330420543593*^9}},ExpressionUUID->"22b6915d-7e21-41d7-943b-\
08c9075e623a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"r0", ",", "p0"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.676336840962946*^9, 
  3.67633684461724*^9}},ExpressionUUID->"839a5bf4-3b41-45d6-9b8a-\
41ab6bb329d5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol Diagram (Numerical)", "Section",
 CellChangeTimes->{{3.674466756424733*^9, 3.67446677978924*^9}, {
   3.6761538650123463`*^9, 3.6761538653835697`*^9}, {3.6761542205292997`*^9, 
   3.676154220529325*^9}, {3.6763357189850616`*^9, 3.676335723230249*^9}, 
   3.676335762629242*^9},ExpressionUUID->"91d0d73e-c1d7-41bb-ab54-\
b56664a73e42"],

Cell[TextData[{
 "Below we focus on the sequence ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["m", "t"], "[", 
     RowBox[{"{", "q", "}"}], "]"}], "}"}], TraditionalForm]],ExpressionUUID->
  "f0aac3eb-a1e9-4114-a649-b39137a111ed"],
 ". The simplified notation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "q"], TraditionalForm]],ExpressionUUID->
  "696ddd17-619c-4915-8bd6-131ab6281474"],
 " may also be used to indicate that the symbol sequence is derived from the ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "36ae7327-fcb5-49f2-b92a-ca11d6b8e747"],
 "-coordinates."
}], "Text",
 CellChangeTimes->{{3.676153771680608*^9, 3.676153787317835*^9}, {
  3.676154185833331*^9, 3.676154185833354*^9}, {3.676154226147463*^9, 
  3.6761542275527782`*^9}, {3.676199479809471*^9, 3.676199535901925*^9}, {
  3.676335813341835*^9, 
  3.6763358212037907`*^9}},ExpressionUUID->"d128daea-5f5a-42bc-90df-\
44021f54edc9"],

Cell[TextData[{
 "To generate the numerical symbol diagram, we spread many points uniformly \
throughout the phase space, compute their symbols (choice from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], TraditionalForm]],
  ExpressionUUID->"877b3dd4-84ab-443a-b730-438602287831"],
 "), and then render each point with a color corresponding to its symbol (",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Red", "=", 
      RowBox[{"-", "2"}]}], ",", " ", 
     RowBox[{"Green", "=", 
      RowBox[{"-", "1"}]}], ",", " ", 
     RowBox[{"Blue", "=", "0"}], ",", " ", 
     RowBox[{"Yellow", "=", "1"}]}], "}"}], TraditionalForm]],ExpressionUUID->
  "d846850c-7eb1-4550-b001-7178a350470c"],
 ")."
}], "Text",
 CellChangeTimes->{{3.676335827747295*^9, 
  3.676335977579466*^9}},ExpressionUUID->"f53c935d-83c6-498c-a4e6-\
ac3a64723323"],

Cell[CellGroupData[{

Cell["Symbol diagram in phase space", "Subsection",
 CellChangeTimes->{{3.6761995493798723`*^9, 3.6761995567036867`*^9}, {
  3.676335995183107*^9, 
  3.676335997647026*^9}},ExpressionUUID->"9e3bfc52-e2a6-417b-a84c-\
4bbe08788058"],

Cell[TextData[{
 "Prepare the sampling points, which are taken to be uniformly distributed \
over ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"[", 
       RowBox[{"0", ",", "1"}]}], ")"}], "\[Times]", 
     RowBox[{"[", 
      RowBox[{"0", ",", "1"}]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "4675996e-7bb9-4e52-bcc3-b279d29bc8ca"],
 ":"
}], "Text",
 CellChangeTimes->{{3.6761535613111763`*^9, 3.6761535842054768`*^9}, {
  3.676199188492798*^9, 
  3.676199214109664*^9}},ExpressionUUID->"772a8ea1-e4c9-4277-9c9c-\
d7bd4da882b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"1", "-", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}], ",", ".005"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"1", "-", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}], ",", ".005"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rs", "//", "Dimensions"}]}], "Input",
 CellChangeTimes->{{3.671970589523602*^9, 3.671970631193367*^9}, {
   3.671970710937077*^9, 3.6719707251576223`*^9}, 3.671970817738997*^9, 
   3.67197263486847*^9, 3.671972846861446*^9, {3.671973585567814*^9, 
   3.67197359171169*^9}, {3.671973987817593*^9, 3.6719739957935038`*^9}, {
   3.671974038445019*^9, 3.6719740387592287`*^9}, {3.671974228353713*^9, 
   3.671974229781348*^9}, 3.671974315230052*^9, {3.671974449178297*^9, 
   3.671974450988875*^9}, {3.671974561210741*^9, 3.671974571031938*^9}, {
   3.6725187556524467`*^9, 3.672518755796262*^9}, {3.6725188719782333`*^9, 
   3.672518886623973*^9}, {3.6725190125160646`*^9, 3.672519029652676*^9}, {
   3.6725190861230793`*^9, 3.672519087329336*^9}, 3.672519149496793*^9, {
   3.6725192540695343`*^9, 3.672519254507841*^9}, {3.67251937006598*^9, 
   3.672519371759778*^9}, {3.6725200713398733`*^9, 3.672520071936697*^9}, {
   3.672520399983466*^9, 3.6725204033177967`*^9}, {3.672524282552446*^9, 
   3.6725242889982443`*^9}, 3.672525003992015*^9, {3.6744146387227583`*^9, 
   3.674414655171878*^9}, {3.674414689012138*^9, 3.674414708386139*^9}, {
   3.674414781776247*^9, 3.674414795814279*^9}, {3.674465428825338*^9, 
   3.674465429633114*^9}, {3.67446560116426*^9, 3.674465603300056*^9}, {
   3.674465682874938*^9, 3.6744656847840433`*^9}, {3.674466022177864*^9, 
   3.674466024511142*^9}, {3.674466080974766*^9, 3.674466082565357*^9}, {
   3.67446973054128*^9, 3.6744697379230843`*^9}, 3.676153557847022*^9, {
   3.676200140382532*^9, 3.676200157244936*^9}, {3.676204414827409*^9, 
   3.676204416951661*^9}, {3.676212623047202*^9, 3.676212625938319*^9}, {
   3.676217962872191*^9, 
   3.676217965053183*^9}},ExpressionUUID->"7ea64053-2164-4980-b731-\
5b956df4c2c8"],

Cell[TextData[{
 "The corresponding integer symbols ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "q"], TraditionalForm]],ExpressionUUID->
  "284299cb-1dc6-4036-8dc6-8c3ed015fb61"],
 " of these points:"
}], "Text",
 CellChangeTimes->{{3.676199254487618*^9, 
  3.6761992841880493`*^9}},ExpressionUUID->"3fe8b03b-9469-4d1c-aece-\
f8d96f5547ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ms", "=", 
   RowBox[{
    RowBox[{"Parallelize", "[", 
     RowBox[{"m", "/@", "rs"}], "]"}], "//", "Round"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ms", "//", "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mqs", "=", 
   RowBox[{"ms", "[", 
    RowBox[{"[", 
     RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.674465563110196*^9, 3.6744655982116528`*^9}, {
   3.674465672795185*^9, 3.674465697048704*^9}, {3.674465766112434*^9, 
   3.674465768391119*^9}, {3.67446580998321*^9, 3.674465878227439*^9}, {
   3.674465991417506*^9, 3.674466000559816*^9}, {3.674466798044305*^9, 
   3.674466798737054*^9}, {3.674468234902569*^9, 3.674468236518199*^9}, 
   3.674506542581773*^9, {3.676199295269598*^9, 
   3.676199295461589*^9}},ExpressionUUID->"a6bcc0a8-2572-4082-81e1-\
2fd9d6d23c9d"],

Cell[TextData[{
 "Find which of these points have symbols ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "2"}], ",", 
    RowBox[{"-", "1"}], ",", "0", ",", "1"}], TraditionalForm]],
  ExpressionUUID->"6097e76c-8665-4056-af97-cbed00691e3e"],
 " respectively. The results are returned as the indices in the original \
sequence of phase space coordinates:"
}], "Text",
 CellChangeTimes->{{3.676199585032058*^9, 3.676199687106299*^9}, {
  3.67633603295166*^9, 
  3.676336035046052*^9}},ExpressionUUID->"40c07d8f-d6e7-4fdf-a8cb-\
371f9eeffd1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Posqs", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"mqs", ",", "#"}], "]"}], "//", "Flatten"}], ")"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{"Join", "@@", "Posqs"}], "]"}], "-", 
   RowBox[{"Range", "[", 
    RowBox[{"Length", "[", "rs", "]"}], "]"}]}], "//", "Norm"}]}], "Input",
 CellChangeTimes->{{3.676199292740609*^9, 
  3.6761992932458687`*^9}},ExpressionUUID->"b5243bf6-5ef4-44af-83d1-\
f5024fcda596"],

Cell["Rendering with colors:", "Text",
 CellChangeTimes->{{3.6761997300144033`*^9, 3.6761997815296383`*^9}, {
  3.676336048725593*^9, 
  3.67633605355748*^9}},ExpressionUUID->"9d9cba6d-f26a-470c-8838-\
81c27f30414b"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", "rs", ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"Posqs", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "4", "]"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], ",", 
   
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.0  Symbol diagram\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.676200247608903*^9, 3.676200252996044*^9}, {
   3.676200315412857*^9, 3.676200341164981*^9}, {3.676218451142823*^9, 
   3.676218457487986*^9}, 3.676336328209587*^9, 
   3.6763365028177156`*^9},ExpressionUUID->"72b05d8f-ff7f-4750-bca4-\
20af3c78ae5d"],

Cell[TextData[{
 "Note that as we are using symbols ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["m", "t"], "[", 
     RowBox[{"{", "q", "}"}], "]"}], "\[Congruent]", 
    RowBox[{
     SubscriptBox["q", 
      RowBox[{"t", "-", "1"}]], "-", 
     RowBox[{
      RowBox[{"Tr", "[", "A", "]"}], " ", 
      SubscriptBox["q", "t"]}], "+", 
     SubscriptBox["q", 
      RowBox[{"t", "+", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "3b78dfdd-c286-422d-84ad-f171b6776ed1"],
 ", the symbol diagram is continuous across the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"q", ",", "0"}], ")"}], TraditionalForm]],ExpressionUUID->
  "507efd22-b3f8-4651-8032-b63b6ccad720"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"q", ",", "1"}], ")"}], TraditionalForm]],ExpressionUUID->
  "bab44200-8d55-4f26-9203-f942002fd8cb"],
 " edges (horizontal), while discontinuous across the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", "p"}], ")"}], TraditionalForm]],ExpressionUUID->
  "fb2de614-a12f-4dae-9edf-92bd99b9acfd"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", ",", "p"}], ")"}], TraditionalForm]],ExpressionUUID->
  "337a17fa-572a-4d3c-9f3c-7b2dc29a0ce8"],
 " edges (vertical). Quantitatively, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["m", "q"], "[", 
      RowBox[{"(", GridBox[{
         {"0"},
         {"p"}
        }], ")"}], "]"}], "-", 
     RowBox[{
      SubscriptBox["m", "q"], "[", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"1", "-", 
           SuperscriptBox["0", "+"]}]},
         {"p"}
        }], ")"}], "]"}]}], "=", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{"-", "2"}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"Tr", "[", "A", "]"}], "=", "3"}]}]}], TraditionalForm]],
  ExpressionUUID->"5d603541-7a27-4f5c-982c-cb9d41d2339e"],
 ". Furthermore, the symbol boundary lines are ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "-", "q"}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "cf984a6e-341b-4605-8442-ee11f0e4da21"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "+", 
     RowBox[{"2", "q"}]}], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "4ba49397-d8eb-45a5-99de-571fbaeed17f"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "+", 
     RowBox[{"2", "q"}]}], "=", "2"}], TraditionalForm]],ExpressionUUID->
  "ecf04695-5f1c-4b65-9752-93fcb2a5ca01"],
 "."
}], "Text",
 CellChangeTimes->{{3.676199826992642*^9, 3.676199994002818*^9}, {
  3.676200035190295*^9, 3.676200038104166*^9}, {3.676200070482561*^9, 
  3.676200099024487*^9}, {3.676336080613208*^9, 3.676336131499362*^9}, {
  3.676336444471753*^9, 
  3.676336467798407*^9}},ExpressionUUID->"b2bbe88a-d8c2-4c98-9214-\
6659538b0a9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol diagrams under iterations", "Subsection",
 CellChangeTimes->{{3.676200407631194*^9, 3.676200412041443*^9}, {
  3.676336147282887*^9, 
  3.676336171362155*^9}},ExpressionUUID->"5dd485f4-bdf1-4b78-86d4-\
a5109ac7c790"],

Cell["\<\
Next we look at the images of every colored region under the single cat map: \
each colored point is carried to its image position under the map while \
remaining the same color.\
\>", "Text",
 CellChangeTimes->{{3.676336191233635*^9, 3.6763362894710503`*^9}, {
  3.676336359125255*^9, 
  3.676336373028842*^9}},ExpressionUUID->"1b868b3a-6e71-4bac-8bea-\
ba4b3c6069c7"],

Cell[CellGroupData[{

Cell["Under forward map", "Subsubsection",
 CellChangeTimes->{{3.676336337261408*^9, 3.676336344637493*^9}, 
   3.676338581231484*^9},ExpressionUUID->"040300bc-dcab-4f08-8647-\
4b5dd9ed1d85"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"f", "/@", "rs"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"Posqs", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.1  1 step forward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"f", "/@", 
          RowBox[{"f", "/@", "rs"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"Posqs", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.2  2 steps forward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"f", "/@", 
          RowBox[{"f", "/@", 
           RowBox[{"f", "/@", "rs"}]}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"Posqs", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.3  3 steps forward\>\""}]}], 
    "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.676200426015121*^9, 3.676200426475606*^9}, {
  3.676200470577889*^9, 3.6762004765629683`*^9}, {3.676200552918008*^9, 
  3.676200567802238*^9}, {3.676218430915897*^9, 3.676218437350279*^9}, {
  3.676336396276766*^9, 3.676336425723748*^9}, {3.6763364926587687`*^9, 
  3.67633650080991*^9}},ExpressionUUID->"b11b373b-187b-433a-8b27-\
38a8add5cc2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Under backward map", "Subsubsection",
 CellChangeTimes->{{3.676336347229281*^9, 
  3.676336351005137*^9}},ExpressionUUID->"f013604f-327f-4213-a923-\
08f1059c495f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fI", "/@", "rs"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"Posqs", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.-1  1 step backward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fI", "/@", 
          RowBox[{"fI", "/@", "rs"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"Posqs", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.-2  2 steps backward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fI", "/@", 
          RowBox[{"fI", "/@", 
           RowBox[{"fI", "/@", "rs"}]}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"Posqs", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "4", "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.-3  3 steps backward\>\""}]}], 
    "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.676200426015121*^9, 3.676200426475606*^9}, {
  3.676200470577889*^9, 3.6762004765629683`*^9}, {3.676200552918008*^9, 
  3.676200567802238*^9}, {3.676218430915897*^9, 3.676218437350279*^9}, {
  3.676336396276766*^9, 3.676336425723748*^9}, {3.6763364926587687`*^9, 
  3.676336558360078*^9}},ExpressionUUID->"4095e35f-1e21-4edd-8d35-\
2793862240ce"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol Diagram (Analytical)", "Section",
 CellChangeTimes->{{3.6763357702689037`*^9, 
  3.676335776932831*^9}},ExpressionUUID->"e697477d-44f0-4916-b72b-\
c61718a27da3"],

Cell[TextData[{
 "Note that each symbol region is a polygon or unions of polygon within the \
unit square. They can be handled in an algebraic (analytical) way indeed, \
thanks to the powerful geometry package introduced since ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " V10."
}], "Text",
 CellChangeTimes->{{3.6763366427664223`*^9, 3.6763366871560993`*^9}, {
  3.676336724339076*^9, 
  3.676336807080969*^9}},ExpressionUUID->"ef0ab755-92b5-4a5a-8c0c-\
b1040ae5b0e3"],

Cell[CellGroupData[{

Cell["Symbol diagram in phase space", "Subsection",
 CellChangeTimes->{{3.6761995493798723`*^9, 3.6761995567036867`*^9}, {
  3.676335995183107*^9, 
  3.676335997647026*^9}},ExpressionUUID->"bc2e7882-60d4-46e6-af27-\
89c587cf1f97"],

Cell["\<\
We encode each colored polygon by a list of vertex coordinates of each \
constituent polygon. Red/Yellow is composed of 1 polygon, while Green/Blue is \
composed of 2 polygons.\
\>", "Text",
 CellChangeTimes->{{3.676336892462358*^9, 
  3.6763369558207893`*^9}},ExpressionUUID->"68019a4c-e454-45b8-b115-\
8322bdaa0527"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rm2", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["2", "3"], ",", 
         FractionBox["2", "3"]}], "}"}]}], "}"}], "}"}]}], ";"}], 
  RowBox[{"(*", "Red", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rm1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["2", "3"], ",", 
          FractionBox["2", "3"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "3"], ",", 
          FractionBox["1", "3"]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["2", "3"], ",", 
          FractionBox["2", "3"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", "Green", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r0", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "3"], ",", 
          FractionBox["1", "3"]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "3"], ",", 
          FractionBox["1", "3"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["2", "3"], ",", 
          FractionBox["2", "3"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", "Blue", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r1", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "3"], ",", 
         FractionBox["1", "3"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "}"}]}], ";"}], 
  RowBox[{"(*", "Yellow", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0s", "=", 
   RowBox[{"Flatten", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{"Polygon", ",", 
      RowBox[{"{", 
       RowBox[{"rm2", ",", "rm1", ",", "r0", ",", "r1"}], "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RegionPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", "p0s", "]"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], ",", 
   
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.0  Symbol diagram\>\""}], ",", 
   RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.676336830262617*^9, 3.6763368303624897`*^9}, {
   3.67633699267559*^9, 3.676337029210833*^9}, {3.676337060193904*^9, 
   3.6763370800892563`*^9}, {3.676337111946094*^9, 3.676337118312292*^9}, {
   3.676337150297174*^9, 3.6763372382306967`*^9}, {3.676337346060315*^9, 
   3.676337375137515*^9}, {3.676337439624116*^9, 3.676337627738351*^9}, {
   3.676337705626137*^9, 3.67633772955364*^9}, {3.676337916346675*^9, 
   3.676337929428796*^9}, {3.676338314651523*^9, 3.676338315016016*^9}, {
   3.6763385436655293`*^9, 3.676338559785006*^9}, {3.676339009900484*^9, 
   3.67633901669811*^9}, {3.676384981735664*^9, 3.676384983680841*^9}, 
   3.6763881332887793`*^9},ExpressionUUID->"fa3c9afa-3d0f-4361-a3a1-\
ee6decea057c"],

Cell["\<\
Their areas - relative frequencies of each symbol - must sum up to 1:\
\>", "Text",
 CellChangeTimes->{{3.6763383213415737`*^9, 3.676338331893388*^9}, {
  3.6763386510389357`*^9, 
  3.6763386966108017`*^9}},ExpressionUUID->"def344ae-2786-47a3-b019-\
926443040045"],

Cell[BoxData[{
 RowBox[{"Map", "[", 
  RowBox[{"Area", ",", "p0s", ",", 
   RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "/@", "%"}]}], "Input",
 CellChangeTimes->{{3.67638817477737*^9, 
  3.676388195544779*^9}},ExpressionUUID->"deb5d9b2-5ddb-4c63-bc45-\
3d91e2d1f32d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol diagrams under iterations", "Subsection",
 CellChangeTimes->{{3.676200407631194*^9, 3.676200412041443*^9}, {
  3.676336147282887*^9, 
  3.676336171362155*^9}},ExpressionUUID->"c8b9d2f2-d819-47db-a4e6-\
70f350b900c6"],

Cell[TextData[{
 "Note that the single cat map is an affine transformation followed by taking \
modulus 1 in both dimensions. We generate the image polygon coordinates first \
(which is simply a matrix multiplication) and then use the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"SquarePolygon01", "[", "]"}], TraditionalForm]],ExpressionUUID->
  "5d2e560a-5670-4f6c-89d5-4e56b7b0b3c8"],
 " function to cut and translate it back to the unit square."
}], "Text",
 CellChangeTimes->{{3.676337764934698*^9, 
  3.67633788921848*^9}},ExpressionUUID->"aff5d8d8-f39a-46c7-bb16-\
250047ce4637"],

Cell[CellGroupData[{

Cell["Under forward map", "Subsubsection",
 CellChangeTimes->{{3.676336337261408*^9, 3.676336344637493*^9}, 
   3.676338581231484*^9},ExpressionUUID->"f7bd4342-0fa7-4140-b5d2-\
f09cdb96512c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PFwd", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MatrixPower", "[", 
             RowBox[{"A", ",", "n"}], "]"}], ".", "#"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"rm2", ",", "rm1", ",", "r0", ",", "r1"}], "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ",", "ps"}], "}"}], ",", 
     RowBox[{"Flatten", "/@", 
      RowBox[{"Map", "[", 
       RowBox[{"SquarePolygon01", ",", "rs", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6763390466170187`*^9, 3.676339143438088*^9}, {
  3.6763391955660667`*^9, 3.6763393600405416`*^9}, {3.6763393915293818`*^9, 
  3.676339607923087*^9}, {3.676339666008451*^9, 3.676339666206918*^9}, {
  3.676384229528421*^9, 
  3.676384232926073*^9}},ExpressionUUID->"0b8ec55b-b464-4384-8c9b-\
1979e66ab51f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1s", ",", "p2s", ",", "p3s"}], "}"}], "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"PFwd", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"RegionPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "p1s", "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.1  1 step forward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"RegionPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "p2s", "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.2  2 steps forward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"RegionPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "p3s", "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.3  3 steps forward\>\""}]}], 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.67633972260874*^9, 3.6763397255176773`*^9}, {
   3.6763398130501537`*^9, 3.676339818001937*^9}, 3.6763399006730843`*^9, {
   3.676384245166465*^9, 3.676384260613929*^9}, {3.676384294005837*^9, 
   3.676384325550599*^9}, {3.676384878299786*^9, 3.676384949546898*^9}, {
   3.6763849918259163`*^9, 
   3.676385009792202*^9}},ExpressionUUID->"56fad068-4bc7-40c3-a1ec-\
15a7041c3054"],

Cell["Check the areas of all colored regions for each step:", "Text",
 CellChangeTimes->{{3.676385113463779*^9, 3.676385150341653*^9}, {
  3.676385384798233*^9, 
  3.676385387340135*^9}},ExpressionUUID->"77443956-d3d4-45f9-baa1-\
39e181374d04"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Total", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{"Area", ",", "#", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"p1s", ",", "p2s", ",", "p3s"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676385155434849*^9, 
  3.676385203433255*^9}},ExpressionUUID->"1fa9e64f-d0d7-4aca-815c-\
9012513c40e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Under backward map", "Subsubsection",
 CellChangeTimes->{{3.676336337261408*^9, 3.676336344637493*^9}, {
  3.676338581231484*^9, 
  3.676338594725761*^9}},ExpressionUUID->"1a2566dd-5f8a-43ff-9d38-\
b785d527e700"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PBkd", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MatrixPower", "[", 
             RowBox[{"AI", ",", "n"}], "]"}], ".", "#"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"rm2", ",", "rm1", ",", "r0", ",", "r1"}], "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ",", "ps"}], "}"}], ",", 
     RowBox[{"Flatten", "/@", 
      RowBox[{"Map", "[", 
       RowBox[{"SquarePolygon01", ",", "rs", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6763390466170187`*^9, 3.676339143438088*^9}, {
  3.6763391955660667`*^9, 3.6763393600405416`*^9}, {3.6763393915293818`*^9, 
  3.676339607923087*^9}, {3.676339666008451*^9, 3.676339666206918*^9}, {
  3.676384229528421*^9, 3.676384232926073*^9}, {3.6763852305900917`*^9, 
  3.676385240231593*^9}},ExpressionUUID->"e4ccd147-d484-4051-8b81-\
e6a5d095bc1f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pm1s", ",", "pm2s", ",", "pm3s"}], "}"}], "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"PBkd", "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"RegionPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "pm1s", "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.-1  1 step backward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"RegionPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "pm2s", "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.-2  2 steps backward\>\""}]}], 
    "]"}], ",", 
   RowBox[{"RegionPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "pm3s", "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue", ",", "Yellow"}], "}"}]}], 
     ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Fig.-3  3 steps backward\>\""}]}], 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.67633972260874*^9, 3.6763397255176773`*^9}, {
   3.6763398130501537`*^9, 3.676339818001937*^9}, 3.6763399006730843`*^9, {
   3.676384245166465*^9, 3.676384260613929*^9}, {3.676384294005837*^9, 
   3.676384325550599*^9}, {3.676384878299786*^9, 3.676384949546898*^9}, {
   3.6763849918259163`*^9, 3.676385009792202*^9}, {3.676385258907949*^9, 
   3.676385303076421*^9}},ExpressionUUID->"e142ef04-bb22-4f84-9cfd-\
35bb196fba02"],

Cell["Check the areas of all colored regions for each step:", "Text",
 CellChangeTimes->{{3.676385113463779*^9, 3.676385150341653*^9}, {
  3.6763853898046093`*^9, 
  3.676385391637774*^9}},ExpressionUUID->"c30d7e69-b9a6-4931-9b9b-\
55a2290837cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Total", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{"Area", ",", "#", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"pm1s", ",", "pm2s", ",", "pm3s"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676385155434849*^9, 3.676385203433255*^9}, {
  3.6763853135504513`*^9, 
  3.676385315878511*^9}},ExpressionUUID->"195cc282-5bf3-4251-a49b-\
508a3259aefa"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Symbol Frequencies (Analytical)", "Section",
 CellChangeTimes->{{3.676389864681945*^9, 
  3.6763898797229424`*^9}},ExpressionUUID->"dceb0e00-a226-4bc2-a248-\
4f4a55548523"],

Cell[CellGroupData[{

Cell["One symbol", "Subsection",
 CellChangeTimes->{{3.676390241960383*^9, 
  3.676390245616015*^9}},ExpressionUUID->"7ccc5e33-e77f-4a12-afd0-\
e91f0428c599"],

Cell["\<\
The occurring frequency of a symbol is proportional to its area. It has been \
evaluated in the previous section but we repeat them here:\
\>", "Text",
 CellChangeTimes->{{3.676390253548019*^9, 
  3.676390321206943*^9}},ExpressionUUID->"ac38cf9b-08a5-437a-838f-\
06c6eb4c27b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Total", "/@", 
    RowBox[{"Map", "[", 
     RowBox[{"Area", ",", "#", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
   "p0s", ",", "p1s", ",", "p2s", ",", "p3s", ",", "pm1s", ",", "pm2s", ",", 
    "pm3s"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676390332986692*^9, 
  3.67639035743363*^9}},ExpressionUUID->"060d5800-ce47-4457-8f04-\
f66b0f63daca"],

Cell[TextData[{
 "Define a variable ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "1"], TraditionalForm]],ExpressionUUID->
  "19bba34e-3ff1-40be-8eb5-42828c6037ef"],
 " for single symbol frequencies, which is later used for calculating \
correlation matrix:"
}], "Text",
 CellChangeTimes->{{3.676391857648102*^9, 
  3.6763918835793333`*^9}},ExpressionUUID->"caa6cbc0-94ad-4981-93d2-\
d31a9e241994"],

Cell[BoxData[
 RowBox[{"f1", "=", 
  RowBox[{"Total", "/@", 
   RowBox[{"Map", "[", 
    RowBox[{"Area", ",", "p0s", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.676391843129953*^9, 
  3.676391851438167*^9}},ExpressionUUID->"1a4389d6-03f2-426d-86d3-\
6b311343337b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two symbols", "Subsection",
 CellChangeTimes->{{3.6763903641829453`*^9, 
  3.676390366207844*^9}},ExpressionUUID->"55fa2482-e164-4477-abbf-\
3df57a002136"],

Cell[TextData[{
 "The occurring frequency of two symbols is proportional to the area of their \
intersections. For example, to obtain the frequency of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{"0", ",", "Any", ",", 
     RowBox[{"-", "1"}]}], "}"}], TraditionalForm]],ExpressionUUID->
  "8fdba62a-b259-40f1-a5ff-ea69d93adf85"],
 ", we shall look at the intersection of Blue in Fig.2 and Green in Fig.0. \
Theoretically, any two figures separated by the same time steps should work, \
and it can used for benchmarking ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s geometry package."
}], "Text",
 CellChangeTimes->{{3.6763903742872972`*^9, 3.676390379618308*^9}, {
  3.6763904100333853`*^9, 
  3.676390606210479*^9}},ExpressionUUID->"2993ad5c-c83f-429e-861f-\
a0102fae6568"],

Cell["\<\
Introduce an intersection area function, which takes lists of polygons as \
inputs, and return the area of their intersections:\
\>", "Text",
 CellChangeTimes->{{3.6763906244245243`*^9, 
  3.6763906940188017`*^9}},ExpressionUUID->"ce8ef7a0-a6a1-457f-9ed8-\
e9b3b285e75f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AreaIntersection", "[", 
    RowBox[{"ps1_", ",", "ps2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Outer", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Area", "[", 
         RowBox[{"RegionIntersection", "[", 
          RowBox[{
           RowBox[{"ps1", "[", 
            RowBox[{"[", "#1", "]"}], "]"}], ",", 
           RowBox[{"ps2", "[", 
            RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "]"}], "&"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "ps1", "]"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "ps2", "]"}], "]"}]}], "]"}], "//", 
     "Flatten"}], "//", "Total"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676390695912307*^9, 3.676390768589572*^9}, {
  3.676390804216176*^9, 3.676390846089225*^9}, {3.676390931141988*^9, 
  3.6763909970342283`*^9}, {3.676391071646324*^9, 
  3.6763910764501343`*^9}},ExpressionUUID->"53c6ac4f-8bea-4f54-a57c-\
44a4cc6a8c93"],

Cell["\<\
Below row index is the earlier symbol, and column index is the later symbol.\
\>", "Text",
 CellChangeTimes->{{3.6763915147054453`*^9, 3.6763915354616127`*^9}, {
  3.676391581059705*^9, 
  3.676391586459281*^9}},ExpressionUUID->"af4e3e57-337d-472a-9c4d-\
c1e4763d703b"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Gap", "=", "0"}], 
  TraditionalForm]],ExpressionUUID->"403c9ab8-4215-479f-a8f9-4702414bb20b"]], \
"Subsubsection",
 CellChangeTimes->{{3.676391085462104*^9, 
  3.676391099682214*^9}},ExpressionUUID->"003f0dec-3db4-4d4e-ba43-\
9cdfa9aa6783"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f20", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AreaIntersection", "[", 
       RowBox[{
        RowBox[{"p1s", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], ",", 
        RowBox[{"p0s", "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f20", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6763912002365007`*^9, 3.676391241874243*^9}, {
  3.676391288800068*^9, 
  3.676391295003051*^9}},ExpressionUUID->"b9717671-7628-4c26-a5bf-\
ae05b6026b3e"],

Cell["\<\
The marginal frequencies, which must reduce to the 1-symbol frequencies:\
\>", "Text",
 CellChangeTimes->{{3.676391304752565*^9, 
  3.676391318859754*^9}},ExpressionUUID->"36f94ab0-44ab-4c5e-aef2-\
9c08405ae910"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f20", "//", "Total"}], 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "row"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f20", "//", "Transpose"}], "//", "Total", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "col"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676391325548738*^9, 
  3.676391371871306*^9}},ExpressionUUID->"62205d00-be02-4e18-a46d-\
1f7cb38e936b"],

Cell["Using other time frames to double-check:", "Text",
 CellChangeTimes->{{3.676391377867478*^9, 
  3.676391395553142*^9}},ExpressionUUID->"edc2981a-13ce-409a-a8f1-\
7456bb112cf5"],

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p1s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"p0s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p2s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"p1s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p3s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"p2s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p0s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm1s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"pm1s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm2s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"pm2s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm3s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676391405590602*^9, 3.676391490010621*^9}, {
  3.676392888693987*^9, 3.676392903421543*^9}, {3.676393010758356*^9, 
  3.676393024179469*^9}},ExpressionUUID->"4f929eb0-7c5f-4652-a605-\
881c1aba8ea0"],

Cell["The correlation matrix:", "Text",
 CellChangeTimes->{{3.676391919535487*^9, 
  3.6763919228204403`*^9}},ExpressionUUID->"5b27e5fd-cfaa-457e-bc8a-\
0c82c2b13a2e"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "=", 
     RowBox[{"f20", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", "f1", ",", "f1"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{"c", "//", "N"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6763920007522717`*^9, 
  3.676392024039629*^9}},ExpressionUUID->"f2a83a37-b36e-4ebf-9820-\
d1b91a1a3170"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Gap", "=", "1"}], 
  TraditionalForm]],ExpressionUUID->"88f8437a-57e3-46b1-b438-ae9cc3a88c15"]], \
"Subsubsection",
 CellChangeTimes->{{3.676391085462104*^9, 3.676391099682214*^9}, {
  3.676391594661656*^9, 
  3.6763915946617193`*^9}},ExpressionUUID->"aabc4e9b-b4c4-4894-be9e-\
7d1893c2c2f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f21", "=", 
   RowBox[{"ParallelArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AreaIntersection", "[", 
       RowBox[{
        RowBox[{"p2s", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], ",", 
        RowBox[{"p0s", "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f21", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6763912002365007`*^9, 3.676391241874243*^9}, {
  3.676391288800068*^9, 3.676391295003051*^9}, {3.676391596325942*^9, 
  3.676391614404811*^9}, {3.676392557091009*^9, 
  3.676392558237657*^9}},ExpressionUUID->"04c08567-37e3-428d-a2aa-\
da9299077b06"],

Cell["\<\
The marginal frequencies, which must reduce to the 1-symbol frequencies:\
\>", "Text",
 CellChangeTimes->{{3.676391304752565*^9, 
  3.676391318859754*^9}},ExpressionUUID->"a279810e-34a3-4fc7-91d3-\
d14ee8fa6e92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f21", "//", "Total"}], 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "row"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f21", "//", "Transpose"}], "//", "Total", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "col"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676391325548738*^9, 3.676391371871306*^9}, {
  3.67639160686794*^9, 
  3.676391607519623*^9}},ExpressionUUID->"b3411fc6-ae51-423d-a6fc-\
d6d367544afc"],

Cell["Using other time frames to double-check:", "Text",
 CellChangeTimes->{{3.676391377867478*^9, 
  3.676391395553142*^9}},ExpressionUUID->"3c1f711e-f004-40d4-8d96-\
27d11740d51d"],

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p2s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"p0s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p3s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"p1s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p1s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm1s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p0s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm2s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"pm1s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm3s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676391405590602*^9, 3.676391490010621*^9}, {
  3.676391648460565*^9, 3.676391676506823*^9}, {3.6763925650678787`*^9, 
  3.6763925801774073`*^9}},ExpressionUUID->"b0c3a403-243a-406e-8978-\
41eccc45dd05"],

Cell["The correlation matrix:", "Text",
 CellChangeTimes->{{3.676391919535487*^9, 
  3.6763919228204403`*^9}},ExpressionUUID->"b4099974-733f-46d8-b676-\
5e425120c7a9"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "=", 
     RowBox[{"f21", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", "f1", ",", "f1"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{"c", "//", "N"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6763920007522717`*^9, 
  3.676392045729988*^9}},ExpressionUUID->"15a29209-9010-4d35-9ae7-\
eaa3c0935a98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Gap", "=", "2"}], 
  TraditionalForm]],ExpressionUUID->"cb85869c-18da-4586-8721-d292b190e5d2"]], \
"Subsubsection",
 CellChangeTimes->{{3.676391085462104*^9, 3.676391099682214*^9}, {
  3.676391594661656*^9, 3.6763915946617193`*^9}, {3.6763916915719213`*^9, 
  3.676391691572028*^9}},ExpressionUUID->"5cb58993-2a22-44e3-b071-\
1766ecbe5dda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f22", "=", 
   RowBox[{"ParallelArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AreaIntersection", "[", 
       RowBox[{
        RowBox[{"p3s", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], ",", 
        RowBox[{"p0s", "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f22", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6763912002365007`*^9, 3.676391241874243*^9}, {
   3.676391288800068*^9, 3.676391295003051*^9}, {3.676391596325942*^9, 
   3.676391614404811*^9}, {3.676391693697241*^9, 3.6763916974208384`*^9}, 
   3.6763925855102882`*^9},ExpressionUUID->"93c2c409-55dd-4960-a8dc-\
f67fcb5b817d"],

Cell["\<\
The marginal frequencies, which must reduce to the 1-symbol frequencies:\
\>", "Text",
 CellChangeTimes->{{3.676391304752565*^9, 
  3.676391318859754*^9}},ExpressionUUID->"a369910c-4eec-40e5-835d-\
2905b3f3a2b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f22", "//", "Total"}], 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "row"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f22", "//", "Transpose"}], "//", "Total", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "col"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676391325548738*^9, 3.676391371871306*^9}, {
  3.67639160686794*^9, 3.676391607519623*^9}, {3.676391750714259*^9, 
  3.676391752772284*^9}},ExpressionUUID->"ded0e9f0-db1e-4909-b09e-\
26384d9f38fe"],

Cell["Using other time frames to double-check:", "Text",
 CellChangeTimes->{{3.676391377867478*^9, 
  3.676391395553142*^9}},ExpressionUUID->"d217dd4a-a70a-441d-b5db-\
02b3bb41f472"],

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p3s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"p0s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p2s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm1s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p1s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm2s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p0s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm3s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676391405590602*^9, 3.676391490010621*^9}, {
  3.676391648460565*^9, 3.676391676506823*^9}, {3.676391767161509*^9, 
  3.676391790157239*^9}, {3.676392587995779*^9, 
  3.676392597254328*^9}},ExpressionUUID->"e88da82d-bc3f-4ac0-895c-\
68d34916bd2d"],

Cell["The correlation matrix:", "Text",
 CellChangeTimes->{{3.676391919535487*^9, 
  3.6763919228204403`*^9}},ExpressionUUID->"1d539fd1-b689-4442-9866-\
55fd7ac69b68"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "=", 
     RowBox[{"f22", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", "f1", ",", "f1"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{"c", "//", "N"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6763920007522717`*^9, 3.676392024039629*^9}, 
   3.676392089111384*^9},ExpressionUUID->"8749d40d-4bf0-4517-9ebc-\
923b818e1672"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Gap", "=", "3"}], 
  TraditionalForm]],ExpressionUUID->"550d8f1c-a027-4dc3-abf2-93fd1eed6632"]], \
"Subsubsection",
 CellChangeTimes->{{3.676391085462104*^9, 3.676391099682214*^9}, {
  3.676391594661656*^9, 3.6763915946617193`*^9}, {3.6763916915719213`*^9, 
  3.676391691572028*^9}, {3.676392117372589*^9, 
  3.676392117372652*^9}},ExpressionUUID->"0ef1b36d-7c9c-4fba-ab27-\
cd4cfa6faaa0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f23", "=", 
   RowBox[{"ParallelArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AreaIntersection", "[", 
       RowBox[{
        RowBox[{"p3s", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], ",", 
        RowBox[{"pm1s", "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f23", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6763912002365007`*^9, 3.676391241874243*^9}, {
   3.676391288800068*^9, 3.676391295003051*^9}, {3.676391596325942*^9, 
   3.676391614404811*^9}, {3.676391693697241*^9, 3.6763916974208384`*^9}, {
   3.6763921193415937`*^9, 3.676392124415328*^9}, 
   3.676392602104286*^9},ExpressionUUID->"842a1861-5faf-4d3a-b97f-\
57144b98be1d"],

Cell["\<\
The marginal frequencies, which must reduce to the 1-symbol frequencies:\
\>", "Text",
 CellChangeTimes->{{3.676391304752565*^9, 
  3.676391318859754*^9}},ExpressionUUID->"10419da9-dcb7-4106-99a6-\
c2793dd7f574"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f23", "//", "Total"}], 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "row"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f23", "//", "Transpose"}], "//", "Total", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "col"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676391325548738*^9, 3.676391371871306*^9}, {
  3.67639160686794*^9, 3.676391607519623*^9}, {3.676391750714259*^9, 
  3.676391752772284*^9}, {3.6763921458471823`*^9, 
  3.676392147376307*^9}},ExpressionUUID->"cb4abcc9-ab7c-4594-8544-\
c2dde6a2d532"],

Cell["Using other time frames to double-check:", "Text",
 CellChangeTimes->{{3.676391377867478*^9, 
  3.676391395553142*^9}},ExpressionUUID->"458d0b58-a810-4af1-99f8-\
29415550f4e9"],

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p3s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm1s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p2s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm2s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p1s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm3s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676391405590602*^9, 3.676391490010621*^9}, {
  3.676391648460565*^9, 3.676391676506823*^9}, {3.676391767161509*^9, 
  3.676391790157239*^9}, {3.6763921553194723`*^9, 3.676392163262158*^9}, {
  3.676392605771175*^9, 
  3.676392610710785*^9}},ExpressionUUID->"762b592c-2e70-44a3-9718-\
78b9a0c671ff"],

Cell["The correlation matrix:", "Text",
 CellChangeTimes->{{3.676391919535487*^9, 
  3.6763919228204403`*^9}},ExpressionUUID->"f96a58ea-67fc-46da-ae61-\
c7ed6423ff21"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "=", 
     RowBox[{"f23", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", "f1", ",", "f1"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{"c", "//", "N"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6763920007522717`*^9, 3.676392024039629*^9}, 
   3.676392089111384*^9, {3.6763921679656076`*^9, 
   3.676392168066037*^9}},ExpressionUUID->"be5fc53d-7ed1-44f3-98fe-\
77e5caff53c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Gap", "=", "4"}], 
  TraditionalForm]],ExpressionUUID->"64ae5f5c-8584-4987-9bdc-25760178c87a"]], \
"Subsubsection",
 CellChangeTimes->{{3.676391085462104*^9, 3.676391099682214*^9}, {
  3.676391594661656*^9, 3.6763915946617193`*^9}, {3.6763916915719213`*^9, 
  3.676391691572028*^9}, {3.6763922377177973`*^9, 
  3.67639223875452*^9}},ExpressionUUID->"479560af-ca29-4aa5-8791-\
eecd96e6999c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f24", "=", 
   RowBox[{"ParallelArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AreaIntersection", "[", 
       RowBox[{
        RowBox[{"p3s", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], ",", 
        RowBox[{"pm2s", "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f24", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6763912002365007`*^9, 3.676391241874243*^9}, {
   3.676391288800068*^9, 3.676391295003051*^9}, {3.676391596325942*^9, 
   3.676391614404811*^9}, {3.676391693697241*^9, 3.6763916974208384`*^9}, {
   3.676392240540394*^9, 3.676392251431251*^9}, 
   3.6763926159728613`*^9},ExpressionUUID->"3ee0ab48-5460-46a2-9362-\
557f3afcc6ca"],

Cell["\<\
The marginal frequencies, which must reduce to the 1-symbol frequencies:\
\>", "Text",
 CellChangeTimes->{{3.676391304752565*^9, 
  3.676391318859754*^9}},ExpressionUUID->"e953390a-7970-45ea-b074-\
c19a2b5a2e33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f24", "//", "Total"}], 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "row"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f24", "//", "Transpose"}], "//", "Total", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "col"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676391325548738*^9, 3.676391371871306*^9}, {
  3.67639160686794*^9, 3.676391607519623*^9}, {3.676391750714259*^9, 
  3.676391752772284*^9}, {3.676392258687868*^9, 
  3.676392259395875*^9}},ExpressionUUID->"1bdbe98c-4a27-42f0-9387-\
3a69da9c42d5"],

Cell["Using other time frames to double-check:", "Text",
 CellChangeTimes->{{3.676391377867478*^9, 
  3.676391395553142*^9}},ExpressionUUID->"2b6bb0df-6b49-4f7a-8448-\
68fcb1ad6444"],

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p3s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm2s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"ParallelArray", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AreaIntersection", "[", 
        RowBox[{
         RowBox[{"p2s", "[", 
          RowBox[{"[", "#1", "]"}], "]"}], ",", 
         RowBox[{"pm3s", "[", 
          RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.676391405590602*^9, 3.676391490010621*^9}, {
  3.676391648460565*^9, 3.676391676506823*^9}, {3.676391767161509*^9, 
  3.676391790157239*^9}, {3.676392269127799*^9, 3.676392294969612*^9}, {
  3.676392620092849*^9, 
  3.67639262380624*^9}},ExpressionUUID->"54861b4d-a152-4346-be14-\
8d55787d6883"],

Cell["The correlation matrix:", "Text",
 CellChangeTimes->{{3.676391919535487*^9, 
  3.6763919228204403`*^9}},ExpressionUUID->"4ac6a779-c825-46b6-8366-\
4ccba2c71c35"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "=", 
     RowBox[{"f24", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", "f1", ",", "f1"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{"c", "//", "N"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6763920007522717`*^9, 3.676392024039629*^9}, 
   3.676392089111384*^9, {3.6763923011571817`*^9, 
   3.676392301280946*^9}},ExpressionUUID->"88e393f5-25a2-4ca3-8681-\
59538ffc41dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"Gap", "=", "5"}], 
  TraditionalForm]],ExpressionUUID->"95aa8e46-a10e-460c-87eb-33dba6369cde"]], \
"Subsubsection",
 CellChangeTimes->{{3.676391085462104*^9, 3.676391099682214*^9}, {
  3.676391594661656*^9, 3.6763915946617193`*^9}, {3.6763916915719213`*^9, 
  3.676391691572028*^9}, {3.676392307919456*^9, 
  3.6763923079195232`*^9}},ExpressionUUID->"bd8439ef-d234-4cdf-8aca-\
e54f43132f91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f25", "=", 
   RowBox[{"ParallelArray", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AreaIntersection", "[", 
       RowBox[{
        RowBox[{"p3s", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], ",", 
        RowBox[{"pm3s", "[", 
         RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f25", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6763912002365007`*^9, 3.676391241874243*^9}, {
   3.676391288800068*^9, 3.676391295003051*^9}, {3.676391596325942*^9, 
   3.676391614404811*^9}, {3.676391693697241*^9, 3.6763916974208384`*^9}, {
   3.676392309730001*^9, 3.6763923189334*^9}, 
   3.676392627406344*^9},ExpressionUUID->"3c76933e-f306-4d79-b30a-\
89093b987c8c"],

Cell["\<\
The marginal frequencies, which must reduce to the 1-symbol frequencies:\
\>", "Text",
 CellChangeTimes->{{3.676391304752565*^9, 
  3.676391318859754*^9}},ExpressionUUID->"4e8953b1-0615-4b08-a890-\
7d985f310cc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f25", "//", "Total"}], 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "row"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f25", "//", "Transpose"}], "//", "Total", 
  RowBox[{"(*", 
   RowBox[{"add", " ", "up", " ", "each", " ", "col"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676391325548738*^9, 3.676391371871306*^9}, {
  3.67639160686794*^9, 3.676391607519623*^9}, {3.676391750714259*^9, 
  3.676391752772284*^9}, {3.676392363360723*^9, 
  3.67639236608235*^9}},ExpressionUUID->"88cbca71-a927-49da-b2de-\
1d48f5dfbc39"],

Cell["Now we have no other available time frames to double-check.", "Text",
 CellChangeTimes->{{3.676391377867478*^9, 3.676391395553142*^9}, {
  3.676392322859679*^9, 
  3.676392357003378*^9}},ExpressionUUID->"b085b552-afe7-49c3-b3da-\
fb83cceac6cd"],

Cell["The correlation matrix:", "Text",
 CellChangeTimes->{{3.676391919535487*^9, 
  3.6763919228204403`*^9}},ExpressionUUID->"8099a0dd-15b6-42d8-aece-\
7ac86546c092"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", "=", 
     RowBox[{"f25", "-", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", "f1", ",", "f1"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"MatrixForm", "/@", 
    RowBox[{"{", 
     RowBox[{"c", ",", 
      RowBox[{"c", "//", "N"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6763920007522717`*^9, 3.676392024039629*^9}, 
   3.676392089111384*^9, {3.676392369806507*^9, 
   3.676392369918898*^9}},ExpressionUUID->"ce365d65-fdc8-4fbe-a625-\
8ca20da4c18b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2560, 1391},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 67, "Section",ExpressionUUID->"9ba479c6-e91b-4012-a66b-85d07147ca64"],
Cell[742, 27, 552, 10, 56, "Text",ExpressionUUID->"35cd8adf-e56b-44dc-b70c-68dbe515b4d6"],
Cell[CellGroupData[{
Cell[1319, 41, 161, 3, 53, "Subsection",ExpressionUUID->"b995870a-50b1-445e-82dd-087672553304"],
Cell[1483, 46, 1454, 45, 51, "Text",ExpressionUUID->"5e0d22b0-d958-4166-85ef-bdd0cdec41e2"],
Cell[2940, 93, 1287, 38, 67, "Input",ExpressionUUID->"1524c4b7-1bd6-4e44-acec-f68478c6b47b"],
Cell[4230, 133, 967, 29, 34, "Text",ExpressionUUID->"ec21f4f7-e168-42f2-9e2e-e99ff3f9b023"],
Cell[5200, 164, 710, 20, 34, "Text",ExpressionUUID->"363fbc3c-0008-43aa-a7bd-3d2f441d0014"],
Cell[5913, 186, 2769, 80, 86, "Input",ExpressionUUID->"a48bfe8c-9dae-4c64-9b98-ec66ddc2a4ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8719, 271, 161, 3, 53, "Subsection",ExpressionUUID->"82372330-ae7e-488b-877e-c27495a97ee4"],
Cell[8883, 276, 367, 7, 34, "Text",ExpressionUUID->"c060453b-2d9a-448b-90e3-29cccb2d7098"],
Cell[9253, 285, 674, 16, 112, "Input",ExpressionUUID->"84b95c5b-7960-4f5c-958b-d1b968cb57c3"],
Cell[9930, 303, 863, 24, 34, "Text",ExpressionUUID->"64fbe84d-874b-475c-8966-b0f0c7856a62"],
Cell[10796, 329, 1733, 52, 131, "Input",ExpressionUUID->"22b6915d-7e21-41d7-943b-08c9075e623a"],
Cell[12532, 383, 227, 6, 28, "Input",ExpressionUUID->"839a5bf4-3b41-45d6-9b8a-41ab6bb329d5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12808, 395, 347, 5, 67, "Section",ExpressionUUID->"91d0d73e-c1d7-41bb-ab54-b56664a73e42"],
Cell[13158, 402, 966, 25, 36, "Text",ExpressionUUID->"d128daea-5f5a-42bc-90df-44021f54edc9"],
Cell[14127, 429, 953, 26, 34, "Text",ExpressionUUID->"f53c935d-83c6-498c-a4e6-ac3a64723323"],
Cell[CellGroupData[{
Cell[15105, 459, 230, 4, 53, "Subsection",ExpressionUUID->"9e3bfc52-e2a6-417b-a84c-4bbe08788058"],
Cell[15338, 465, 574, 18, 34, "Text",ExpressionUUID->"772a8ea1-e4c9-4277-9c9c-d7bd4da882b5"],
Cell[15915, 485, 2391, 45, 52, "Input",ExpressionUUID->"7ea64053-2164-4980-b731-5b956df4c2c8"],
Cell[18309, 532, 346, 10, 34, "Text",ExpressionUUID->"3fe8b03b-9469-4d1c-aece-f8d96f5547ed"],
Cell[18658, 544, 875, 20, 63, "Input",ExpressionUUID->"a6bcc0a8-2572-4082-81e1-2fd9d6d23c9d"],
Cell[19536, 566, 551, 14, 31, "Text",ExpressionUUID->"40c07d8f-d6e7-4fdf-a8cb-371f9eeffd1d"],
Cell[20090, 582, 755, 23, 46, "Input",ExpressionUUID->"b5243bf6-5ef4-44af-83d1-f5024fcda596"],
Cell[20848, 607, 216, 4, 30, "Text",ExpressionUUID->"9d9cba6d-f26a-470c-8838-81c27f30414b"],
Cell[21067, 613, 1149, 30, 28, "Input",ExpressionUUID->"72b05d8f-ff7f-4750-bca4-20af3c78ae5d"],
Cell[22219, 645, 2856, 94, 50, "Text",ExpressionUUID->"b2bbe88a-d8c2-4c98-9214-6659538b0a9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25112, 744, 229, 4, 44, "Subsection",ExpressionUUID->"5dd485f4-bdf1-4b78-86d4-a5109ac7c790"],
Cell[25344, 750, 379, 8, 30, "Text",ExpressionUUID->"1b868b3a-6e71-4bac-8bea-ba4b3c6069c7"],
Cell[CellGroupData[{
Cell[25748, 762, 191, 3, 35, "Subsubsection",ExpressionUUID->"040300bc-dcab-4f08-8647-4b5dd9ed1d85"],
Cell[25942, 767, 3192, 89, 63, "Input",ExpressionUUID->"b11b373b-187b-433a-8b27-38a8add5cc2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29171, 861, 169, 3, 35, "Subsubsection",ExpressionUUID->"f013604f-327f-4213-a923-08f1059c495f"],
Cell[29343, 866, 3205, 89, 63, "Input",ExpressionUUID->"4095e35f-1e21-4edd-8d35-2793862240ce"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32609, 962, 174, 3, 64, "Section",ExpressionUUID->"e697477d-44f0-4916-b72b-c61718a27da3"],
Cell[32786, 967, 478, 11, 30, "Text",ExpressionUUID->"ef0ab755-92b5-4a5a-8c0c-b1040ae5b0e3"],
Cell[CellGroupData[{
Cell[33289, 982, 230, 4, 44, "Subsection",ExpressionUUID->"bc2e7882-60d4-46e6-af27-89c587cf1f97"],
Cell[33522, 988, 328, 7, 30, "Text",ExpressionUUID->"68019a4c-e454-45b8-b115-8322bdaa0527"],
Cell[33853, 997, 4438, 130, 203, "Input",ExpressionUUID->"fa3c9afa-3d0f-4361-a3a1-ee6decea057c"],
Cell[38294, 1129, 274, 6, 30, "Text",ExpressionUUID->"def344ae-2786-47a3-b019-926443040045"],
Cell[38571, 1137, 300, 7, 46, "Input",ExpressionUUID->"deb5d9b2-5ddb-4c63-bc45-3d91e2d1f32d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38908, 1149, 229, 4, 44, "Subsection",ExpressionUUID->"c8b9d2f2-d819-47db-a4e6-70f350b900c6"],
Cell[39140, 1155, 582, 12, 32, "Text",ExpressionUUID->"aff5d8d8-f39a-46c7-bb16-250047ce4637"],
Cell[CellGroupData[{
Cell[39747, 1171, 191, 3, 35, "Subsubsection",ExpressionUUID->"f7bd4342-0fa7-4140-b5d2-f09cdb96512c"],
Cell[39941, 1176, 1055, 27, 28, "Input",ExpressionUUID->"0b8ec55b-b464-4384-8c9b-1979e66ab51f"],
Cell[40999, 1205, 2577, 69, 63, "Input",ExpressionUUID->"56fad068-4bc7-40c3-a1ec-15a7041c3054"],
Cell[43579, 1276, 244, 4, 30, "Text",ExpressionUUID->"77443956-d3d4-45f9-baa1-39e181374d04"],
Cell[43826, 1282, 384, 11, 28, "Input",ExpressionUUID->"1fa9e64f-d0d7-4aca-815c-9012513c40e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44247, 1298, 218, 4, 35, "Subsubsection",ExpressionUUID->"1a2566dd-5f8a-43ff-9d38-b785d527e700"],
Cell[44468, 1304, 1104, 27, 28, "Input",ExpressionUUID->"e4ccd147-d484-4051-8b81-e6a5d095bc1f"],
Cell[45575, 1333, 2635, 69, 63, "Input",ExpressionUUID->"e142ef04-bb22-4f84-9cfd-35bb196fba02"],
Cell[48213, 1404, 246, 4, 30, "Text",ExpressionUUID->"c30d7e69-b9a6-4931-9b9b-55a2290837cf"],
Cell[48462, 1410, 438, 12, 28, "Input",ExpressionUUID->"195cc282-5bf3-4251-a49b-508a3259aefa"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48961, 1429, 178, 3, 64, "Section",ExpressionUUID->"dceb0e00-a226-4bc2-a248-4f4a55548523"],
Cell[CellGroupData[{
Cell[49164, 1436, 158, 3, 44, "Subsection",ExpressionUUID->"7ccc5e33-e77f-4a12-afd0-e91f0428c599"],
Cell[49325, 1441, 287, 6, 30, "Text",ExpressionUUID->"ac38cf9b-08a5-437a-838f-06c6eb4c27b4"],
Cell[49615, 1449, 443, 13, 28, "Input",ExpressionUUID->"060d5800-ce47-4457-8f04-f66b0f63daca"],
Cell[50061, 1464, 402, 11, 32, "Text",ExpressionUUID->"caa6cbc0-94ad-4981-93d2-d31a9e241994"],
Cell[50466, 1477, 301, 8, 28, "Input",ExpressionUUID->"1a4389d6-03f2-426d-86d3-6b311343337b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50804, 1490, 161, 3, 44, "Subsection",ExpressionUUID->"55fa2482-e164-4477-abbf-3df57a002136"],
Cell[50968, 1495, 816, 19, 32, "Text",ExpressionUUID->"2993ad5c-c83f-429e-861f-a0102fae6568"],
Cell[51787, 1516, 281, 6, 30, "Text",ExpressionUUID->"ce8ef7a0-a6a1-457f-9ed8-e9b3b285e75f"],
Cell[52071, 1524, 1001, 26, 28, "Input",ExpressionUUID->"53c6ac4f-8bea-4f54-a57c-44a4cc6a8c93"],
Cell[53075, 1552, 279, 6, 30, "Text",ExpressionUUID->"af4e3e57-337d-472a-9c4d-c1e4763d703b"],
Cell[CellGroupData[{
Cell[53379, 1562, 290, 7, 36, "Subsubsection",ExpressionUUID->"003f0dec-3db4-4d4e-ba43-9cdfa9aa6783"],
Cell[53672, 1571, 651, 18, 46, "Input",ExpressionUUID->"b9717671-7628-4c26-a5bf-ae05b6026b3e"],
Cell[54326, 1591, 222, 5, 30, "Text",ExpressionUUID->"36f94ab0-44ab-4c5e-aef2-9c08405ae910"],
Cell[54551, 1598, 454, 12, 46, "Input",ExpressionUUID->"62205d00-be02-4e18-a46d-1f7cb38e936b"],
Cell[55008, 1612, 182, 3, 30, "Text",ExpressionUUID->"edc2981a-13ce-409a-a8f1-7456bb112cf5"],
Cell[55193, 1617, 2532, 73, 46, "Input",ExpressionUUID->"4f929eb0-7c5f-4652-a605-881c1aba8ea0"],
Cell[57728, 1692, 167, 3, 30, "Text",ExpressionUUID->"5b27e5fd-cfaa-457e-bc8a-0c82c2b13a2e"],
Cell[57898, 1697, 480, 14, 28, "Input",ExpressionUUID->"f2a83a37-b36e-4ebf-9820-d1b91a1a3170"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58415, 1716, 341, 8, 36, "Subsubsection",ExpressionUUID->"aabc4e9b-b4c4-4894-be9e-7d1893c2c2f6"],
Cell[58759, 1726, 754, 19, 46, "Input",ExpressionUUID->"04c08567-37e3-428d-a2aa-da9299077b06"],
Cell[59516, 1747, 222, 5, 30, "Text",ExpressionUUID->"a279810e-34a3-4fc7-91d3-d14ee8fa6e92"],
Cell[59741, 1754, 502, 13, 46, "Input",ExpressionUUID->"b3411fc6-ae51-423d-a6fc-d6d367544afc"],
Cell[60246, 1769, 182, 3, 30, "Text",ExpressionUUID->"3c1f711e-f004-40d4-8d96-27d11740d51d"],
Cell[60431, 1774, 2165, 62, 46, "Input",ExpressionUUID->"b0c3a403-243a-406e-8978-41eccc45dd05"],
Cell[62599, 1838, 167, 3, 30, "Text",ExpressionUUID->"b4099974-733f-46d8-b676-5e425120c7a9"],
Cell[62769, 1843, 480, 14, 28, "Input",ExpressionUUID->"15a29209-9010-4d35-9ae7-eaa3c0935a98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63286, 1862, 389, 8, 36, "Subsubsection",ExpressionUUID->"5cb58993-2a22-44e3-b071-1766ecbe5dda"],
Cell[63678, 1872, 783, 19, 46, "Input",ExpressionUUID->"93c2c409-55dd-4960-a8dc-f67fcb5b817d"],
Cell[64464, 1893, 222, 5, 30, "Text",ExpressionUUID->"a369910c-4eec-40e5-835d-2905b3f3a2b9"],
Cell[64689, 1900, 548, 13, 46, "Input",ExpressionUUID->"ded0e9f0-db1e-4909-b09e-26384d9f38fe"],
Cell[65240, 1915, 182, 3, 30, "Text",ExpressionUUID->"d217dd4a-a70a-441d-b5db-02b3bb41f472"],
Cell[65425, 1920, 1839, 52, 28, "Input",ExpressionUUID->"e88da82d-bc3f-4ac0-895c-68d34916bd2d"],
Cell[67267, 1974, 167, 3, 30, "Text",ExpressionUUID->"1d539fd1-b689-4442-9866-55fd7ac69b68"],
Cell[67437, 1979, 503, 14, 28, "Input",ExpressionUUID->"8749d40d-4bf0-4517-9ebc-923b818e1672"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67977, 1998, 438, 9, 36, "Subsubsection",ExpressionUUID->"0ef1b36d-7c9c-4fba-ab27-cd4cfa6faaa0"],
Cell[68418, 2009, 834, 20, 46, "Input",ExpressionUUID->"842a1861-5faf-4d3a-b97f-57144b98be1d"],
Cell[69255, 2031, 222, 5, 30, "Text",ExpressionUUID->"10419da9-dcb7-4106-99a6-c2793dd7f574"],
Cell[69480, 2038, 599, 14, 46, "Input",ExpressionUUID->"cb4abcc9-ab7c-4594-8544-c2dde6a2d532"],
Cell[70082, 2054, 182, 3, 30, "Text",ExpressionUUID->"458d0b58-a810-4af1-99f8-29415550f4e9"],
Cell[70267, 2059, 1520, 42, 28, "Input",ExpressionUUID->"762b592c-2e70-44a3-9718-78b9a0c671ff"],
Cell[71790, 2103, 167, 3, 30, "Text",ExpressionUUID->"f96a58ea-67fc-46da-ae61-c7ed6423ff21"],
Cell[71960, 2108, 555, 15, 28, "Input",ExpressionUUID->"be5fc53d-7ed1-44f3-98fe-77e5caff53c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72552, 2128, 439, 9, 36, "Subsubsection",ExpressionUUID->"479560af-ca29-4aa5-8791-eecd96e6999c"],
Cell[72994, 2139, 834, 20, 46, "Input",ExpressionUUID->"3ee0ab48-5460-46a2-9362-557f3afcc6ca"],
Cell[73831, 2161, 222, 5, 30, "Text",ExpressionUUID->"e953390a-7970-45ea-b074-c19a2b5a2e33"],
Cell[74056, 2168, 597, 14, 46, "Input",ExpressionUUID->"1bdbe98c-4a27-42f0-9387-3a69da9c42d5"],
Cell[74656, 2184, 182, 3, 30, "Text",ExpressionUUID->"2b6bb0df-6b49-4f7a-8448-68fcb1ad6444"],
Cell[74841, 2189, 1146, 31, 28, "Input",ExpressionUUID->"54861b4d-a152-4346-be14-8d55787d6883"],
Cell[75990, 2222, 167, 3, 30, "Text",ExpressionUUID->"4ac6a779-c825-46b6-8366-4ccba2c71c35"],
Cell[76160, 2227, 555, 15, 28, "Input",ExpressionUUID->"88e393f5-25a2-4ca3-8681-59538ffc41dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76752, 2247, 440, 9, 36, "Subsubsection",ExpressionUUID->"bd8439ef-d234-4cdf-8aca-e54f43132f91"],
Cell[77195, 2258, 830, 20, 46, "Input",ExpressionUUID->"3c76933e-f306-4d79-b30a-89093b987c8c"],
Cell[78028, 2280, 222, 5, 30, "Text",ExpressionUUID->"4e8953b1-0615-4b08-a890-7d985f310cc0"],
Cell[78253, 2287, 596, 14, 46, "Input",ExpressionUUID->"88cbca71-a927-49da-b2de-1d48f5dfbc39"],
Cell[78852, 2303, 250, 4, 30, "Text",ExpressionUUID->"b085b552-afe7-49c3-b3da-fb83cceac6cd"],
Cell[79105, 2309, 167, 3, 30, "Text",ExpressionUUID->"8099a0dd-15b6-42d8-aece-7ac86546c092"],
Cell[79275, 2314, 553, 15, 28, "Input",ExpressionUUID->"ce365d65-fdc8-4fbe-a625-8ca20da4c18b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

