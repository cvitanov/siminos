(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     39788,        888]
NotebookOptionsPosition[     36790,        841]
NotebookOutlinePosition[     37188,        857]
CellTagsIndexPosition[     37145,        854]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tensors on d=2 spacetime lattice", "Title",
 CellChangeTimes->{{3.790723910504032*^9, 3.7907239253597727`*^9}, {
  3.7907327832471566`*^9, 
  3.7907327989024677`*^9}},ExpressionUUID->"65f12e0a-663c-4829-a857-\
62b949ad3f96"],

Cell[TextData[{
 "Predrag   &  Han  calculations for CL18.tex\nConstruction of the orbit \
Jacobian for the 2d lattice Bravais cell with basis vectors\n         ",
 Cell[BoxData[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"L", "S"},
     {"0", "T"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  CellChangeTimes->{3.7909367566810474`*^9},ExpressionUUID->
  "cdbf0144-8c25-49db-a288-50c297b7551b"],
 "\[LineSeparator]L= space period, T=time period, L\[GreaterSlantEqual]T, 0\
\[LessSlantEqual]S<L relative-periodic shift (\[OpenCurlyQuote]tilt\
\[CloseCurlyQuote], \[OpenCurlyQuote]slant\[CloseCurlyQuote], \
\[OpenCurlyQuote]screw\[CloseCurlyQuote])\n \nEvaluation of its determinant, \
ie., the number of periodic lattice states."
}], "Text",
 CellChangeTimes->{{3.790724895657461*^9, 3.790724941392991*^9}, {
  3.790732741495022*^9, 3.790732769302803*^9}, {3.790732806134979*^9, 
  3.790732823102466*^9}, {3.7907904887195187`*^9, 3.790790506360324*^9}, {
  3.790865112301575*^9, 3.790865113944332*^9}, {3.790935989968202*^9, 
  3.7909360270372443`*^9}, {3.7909370397183237`*^9, 3.790937086787409*^9}, {
  3.790937119590131*^9, 3.790937348479441*^9}, {3.790938118547861*^9, 
  3.7909381224288697`*^9}, {3.7909514387858305`*^9, 3.790951443617321*^9}, {
  3.8083953201235504`*^9, 
  3.8083953437623167`*^9}},ExpressionUUID->"2c3bd703-ec2a-4f13-97d2-\
4b28b1b2f855"],

Cell[CellGroupData[{

Cell["[L\[Times]T] Bravais rectangular cell", "Section",
 CellChangeTimes->{
  3.7909516656209445`*^9},ExpressionUUID->"f9c16f3e-8403-4a1b-801e-\
966d591591f7"],

Cell["\<\
Construction of the  orbit Jacobian      \t\t\t\t\t\t\t\tcoded 2020-02-16
    \[ScriptCapitalJ](s) = (\[Sigma]_left + \[Sigma]_down - 2s Id + \
\[Sigma]_up + \[Sigma]_right)
for [L\[Times]T] Bravais rectangular cell\
\>", "Text",
 CellChangeTimes->{{3.7907239643314924`*^9, 3.790723967813324*^9}, 
   3.7907240142204113`*^9, {3.7907241623231444`*^9, 3.7907241953075943`*^9}, {
   3.7907243006699686`*^9, 3.7907243275862055`*^9}, {3.7907244120176215`*^9, 
   3.7907244872717533`*^9}, {3.7907245941272097`*^9, 
   3.7907246139338775`*^9}, {3.7907247328048553`*^9, 3.7907247487799087`*^9}, 
   3.790724783701163*^9, {3.790724823827178*^9, 3.790724880242057*^9}, 
   3.7907249333290105`*^9, {3.790725126710631*^9, 3.7907251469020653`*^9}, {
   3.7907254472921376`*^9, 3.790725461369381*^9}, {3.7907286881772423`*^9, 
   3.790728694039603*^9}, {3.7907294048864574`*^9, 3.7907295642375965`*^9}, {
   3.7907304744100885`*^9, 3.7907305561454062`*^9}, {3.7907321906143074`*^9, 
   3.7907322054461164`*^9}, 3.790732472234828*^9, {3.790790516928082*^9, 
   3.790790519655783*^9}, 3.790792357749566*^9, 3.790792454386221*^9, {
   3.79079263926182*^9, 3.7907926424430847`*^9}, 3.7907927243920045`*^9, 
   3.7907939603466597`*^9, 3.7908598495932884`*^9, {3.790860003132106*^9, 
   3.7908600101926775`*^9}, {3.790860216125799*^9, 3.7908602280975623`*^9}, 
   3.790861114843075*^9, 3.7908612799325047`*^9, 3.7908616259550986`*^9, {
   3.7908620181987305`*^9, 3.7908620207381883`*^9}, {3.7908651227215614`*^9, 
   3.7908651234219465`*^9}, 3.7908654100694127`*^9, 3.7908654667902074`*^9, 
   3.790865568360182*^9, 3.7908657580168056`*^9, {3.7908658370276775`*^9, 
   3.7908658393192863`*^9}, {3.790868602375682*^9, 3.790868602846658*^9}, 
   3.7908686342650824`*^9, {3.7908686692516155`*^9, 3.7908687608628597`*^9}, 
   3.7908691569232*^9, 3.7908723326891375`*^9, {3.790935843807158*^9, 
   3.790935892136011*^9}, {3.790935994755576*^9, 3.7909360044222717`*^9}, {
   3.7909367352328854`*^9, 3.7909367462361965`*^9}, {3.790936991047634*^9, 
   3.7909369922673264`*^9}, {3.790937450028463*^9, 3.790937460540177*^9}, {
   3.7909380211659*^9, 3.790938040223935*^9}, {3.7909381115623145`*^9, 
   3.7909381142175837`*^9}, 3.7909382557568693`*^9, {3.7909494279842863`*^9, 
   3.790949459421221*^9}, 3.7909494955195265`*^9, 3.7909495980448155`*^9, 
   3.790949719345312*^9, 3.790949857502795*^9, {3.7909499751440535`*^9, 
   3.7909499800286784`*^9}, 3.790950051379222*^9, {3.790950122582182*^9, 
   3.7909501245725007`*^9}, 3.79095020910193*^9, {3.790950343602078*^9, 
   3.790950347413861*^9}, 3.790950683795477*^9, 3.790950718728749*^9, 
   3.7909507579328017`*^9, {3.7909511078212233`*^9, 3.7909511253432407`*^9}, {
   3.7909513360797005`*^9, 
   3.7909514528627243`*^9}},ExpressionUUID->"fecd480d-d6d8-4eca-8c1c-\
061fb6f6f9fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "4"}], ";", " ", 
   RowBox[{"T", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{"L", "\[Times]", "T"}], "]"}], " ", "rectangular", " ", "cell"}],
    " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", "1"}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"[", 
      RowBox[{"L", "\[Times]", "T"}], "]"}], "_S"}], ",", " ", 
    RowBox[{
    "S", " ", "is", " ", "the", " ", "relative", " ", "shift", " ", "in", " ",
      "the", " ", "space", " ", "direction"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{"5", "/", "2"}]}], ";"}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.7907239643314924`*^9, 3.790723967813324*^9}, 
   3.7907240142204113`*^9, {3.7907241623231444`*^9, 3.7907241953075943`*^9}, {
   3.7907243006699686`*^9, 3.7907243275862055`*^9}, {3.7907244120176215`*^9, 
   3.7907244872717533`*^9}, {3.7907245941272097`*^9, 
   3.7907246139338775`*^9}, {3.7907247328048553`*^9, 3.7907247487799087`*^9}, 
   3.790724783701163*^9, {3.790724823827178*^9, 3.790724880242057*^9}, 
   3.7907249333290105`*^9, {3.790725126710631*^9, 3.7907251469020653`*^9}, {
   3.7907254472921376`*^9, 3.790725461369381*^9}, {3.7907286881772423`*^9, 
   3.790728694039603*^9}, {3.7907294048864574`*^9, 3.7907295642375965`*^9}, {
   3.7907304744100885`*^9, 3.7907305561454062`*^9}, {3.7907321906143074`*^9, 
   3.7907322054461164`*^9}, 3.790732472234828*^9, {3.790790516928082*^9, 
   3.790790519655783*^9}, 3.790792357749566*^9, 3.790792454386221*^9, {
   3.79079263926182*^9, 3.7907926424430847`*^9}, 3.7907927243920045`*^9, 
   3.7907939603466597`*^9, 3.7908598495932884`*^9, {3.790860003132106*^9, 
   3.7908600101926775`*^9}, {3.790860216125799*^9, 3.7908602280975623`*^9}, 
   3.790861114843075*^9, 3.7908612799325047`*^9, 3.7908616259550986`*^9, {
   3.7908620181987305`*^9, 3.7908620207381883`*^9}, {3.7908651227215614`*^9, 
   3.7908651234219465`*^9}, 3.7908654100694127`*^9, 3.7908654667902074`*^9, 
   3.790865568360182*^9, 3.7908657580168056`*^9, {3.7908658370276775`*^9, 
   3.7908658393192863`*^9}, {3.790868602375682*^9, 3.790868602846658*^9}, 
   3.7908686342650824`*^9, {3.7908686692516155`*^9, 3.7908687608628597`*^9}, 
   3.7908691569232*^9, 3.7908723326891375`*^9, {3.790935843807158*^9, 
   3.790935892136011*^9}, {3.790935994755576*^9, 3.7909360044222717`*^9}, {
   3.7909367352328854`*^9, 3.7909367462361965`*^9}, {3.790936991047634*^9, 
   3.7909369922673264`*^9}, {3.790937450028463*^9, 3.790937460540177*^9}, {
   3.7909380211659*^9, 3.790938040223935*^9}, {3.7909381115623145`*^9, 
   3.7909381142175837`*^9}, 3.7909382557568693`*^9, {3.7909494279842863`*^9, 
   3.790949459421221*^9}, 3.7909494955195265`*^9, 3.7909495980448155`*^9, 
   3.790949719345312*^9, 3.790949857502795*^9, {3.7909499751440535`*^9, 
   3.7909499800286784`*^9}, 3.790950051379222*^9, {3.790950122582182*^9, 
   3.7909501245725007`*^9}, 3.79095020910193*^9, {3.790950343602078*^9, 
   3.790950347413861*^9}, 3.790950683795477*^9, 3.790950718728749*^9, 
   3.7909507579328017`*^9, {3.7909511078212233`*^9, 3.7909511253432407`*^9}, 
   3.7909513360797005`*^9, {3.7915064242994833`*^9, 3.7915064339108887`*^9}, 
   3.791506487130679*^9, {3.7915065569692793`*^9, 3.7915065616033497`*^9}, 
   3.7915065943454494`*^9, 3.7915068033504896`*^9, 3.7915069780203433`*^9, {
   3.7915072828877583`*^9, 3.7915072859518538`*^9}, 3.791507406942706*^9, {
   3.791507510812854*^9, 3.7915075162444773`*^9}, 3.7915077492820168`*^9, 
   3.7915078229931936`*^9, 3.791507923215246*^9, {3.7915080405440607`*^9, 
   3.791508045309477*^9}, {3.791508768556121*^9, 
   3.791508773196329*^9}},ExpressionUUID->"01e184e3-95dd-4225-9e91-\
96da952069ac"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "attempt", " ", "to", " ", "print", " ", "out", " ", "tensor", " ", 
    "arrays"}], ",", " ", 
   RowBox[{
    RowBox[{
    "did", " ", "not", " ", "figure", " ", "out", " ", "how", " ", "to", " ", 
     "index", " ", "them", " ", "so", " ", "they", " ", "start", " ", "with", 
     " ", "0", "\n", "m"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["a", "##"], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "\n", "m"}], "//", 
     "MatrixForm"}]}]}], "\n", "*)"}]], "Code",
 CellChangeTimes->{{3.790888836628949*^9, 3.7908888551957784`*^9}, {
  3.790892452839714*^9, 3.790892533846383*^9}, {3.7908927458322697`*^9, 
  3.7908928059469337`*^9}, {3.7909011211488056`*^9, 
  3.7909011825442247`*^9}},ExpressionUUID->"5868847f-71e8-4d37-87e0-\
32df9c8285d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"id1", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"KroneckerDelta", ",", 
     RowBox[{"{", 
      RowBox[{"L", ",", "L"}], "}"}]}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"diagonal", ",", " ", 
    RowBox[{"space", " ", "direction"}]}], " ", "*)"}]}], "\n", 
 RowBox[{"id2", "=", 
  RowBox[{"Array", "[", 
   RowBox[{"KroneckerDelta", ",", 
    RowBox[{"{", 
     RowBox[{"T", ",", "T"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"diagonal", ",", " ", 
    RowBox[{"time", " ", "direction"}]}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.7907239643314924`*^9, 3.790723967813324*^9}, 
   3.7907240142204113`*^9, {3.7907241623231444`*^9, 3.7907241953075943`*^9}, {
   3.7907243006699686`*^9, 3.7907243275862055`*^9}, {3.7907244120176215`*^9, 
   3.7907244872717533`*^9}, {3.7907245941272097`*^9, 
   3.7907246139338775`*^9}, {3.7907247328048553`*^9, 3.7907247487799087`*^9}, 
   3.790724783701163*^9, {3.790724823827178*^9, 3.790724880242057*^9}, 
   3.7907249333290105`*^9, {3.790725126710631*^9, 3.7907251469020653`*^9}, {
   3.7907254472921376`*^9, 3.790725461369381*^9}, {3.7907286881772423`*^9, 
   3.790728694039603*^9}, {3.7907294048864574`*^9, 3.7907295642375965`*^9}, 
   3.7907304744100885`*^9, {3.7907307779049163`*^9, 
   3.790730789158939*^9}},ExpressionUUID->"d36b6388-c035-486f-94ff-\
80bcdcfd5dda"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Kronecker2d", "=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"id1", ",", "id2"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"diagonal", ",", " ", "spacetime"}], " ", "*)"}]}]], "Code",
 CellChangeTimes->{{3.7907239643314924`*^9, 3.790723967813324*^9}, 
   3.7907240142204113`*^9, {3.7907241623231444`*^9, 3.7907241953075943`*^9}, {
   3.7907243006699686`*^9, 3.7907243275862055`*^9}, {3.7907244120176215`*^9, 
   3.7907244872717533`*^9}, {3.7907245941272097`*^9, 
   3.7907246139338775`*^9}, {3.7907247328048553`*^9, 3.7907247487799087`*^9}, 
   3.790724783701163*^9, {3.790724823827178*^9, 3.790724880242057*^9}, 
   3.7907249333290105`*^9, {3.790725126710631*^9, 3.7907251469020653`*^9}, {
   3.7907254472921376`*^9, 3.790725461369381*^9}, {3.7907286881772423`*^9, 
   3.790728694039603*^9}, {3.7907294048864574`*^9, 3.7907294607587967`*^9}, {
   3.7907296414606886`*^9, 3.790729649371781*^9}, {3.7907308049831285`*^9, 
   3.790730808582896*^9}, 
   3.7907308760378237`*^9},ExpressionUUID->"b7598e2d-628f-495f-86d8-\
66686c3125eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shiftLeft", "=", 
   RowBox[{"RotateLeft", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"KroneckerDelta", ",", 
      RowBox[{"{", 
       RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"shift", ",", " ", 
    RowBox[{"space", " ", "only"}]}], " ", "*)"}]}], "\n", 
 RowBox[{"shiftRight", "=", 
  RowBox[{"RotateRight", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"KroneckerDelta", ",", 
     RowBox[{"{", 
      RowBox[{"L", ",", "L"}], "}"}]}], "]"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"back", " ", "shift"}], ",", " ", 
    RowBox[{"space", " ", "only"}]}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.790725262612059*^9, 3.7907252934528675`*^9}, {
   3.79072560924139*^9, 3.79072561743929*^9}, {3.7907256554576373`*^9, 
   3.790725708190832*^9}, {3.7907257461112456`*^9, 3.7907257577979774`*^9}, 
   3.790726438268858*^9, {3.7907264868046875`*^9, 3.7907264881158733`*^9}, {
   3.790726527524377*^9, 3.790726551579423*^9}, {3.7907266167419186`*^9, 
   3.7907266388032064`*^9}, {3.7907268869469852`*^9, 3.7907269379343*^9}, {
   3.7907270248602924`*^9, 3.7907270304128437`*^9}, {3.790727238218734*^9, 
   3.7907272484813576`*^9}, {3.7907273507378254`*^9, 
   3.7907273986090837`*^9}, {3.7907274481463065`*^9, 
   3.7907274687984753`*^9}, {3.790727502753379*^9, 3.7907275186385098`*^9}, {
   3.7907275542533836`*^9, 3.790727603158004*^9}, {3.7907289166384315`*^9, 
   3.790728947012579*^9}, {3.7907290422114906`*^9, 3.7907290488593645`*^9}, {
   3.790729576149208*^9, 3.7907295798359194`*^9}, {3.790729678715579*^9, 
   3.790729687331235*^9}, {3.7907297706345615`*^9, 3.790729771561987*^9}, 
   3.7907300889431305`*^9, 
   3.790888210873098*^9},ExpressionUUID->"ac514317-f813-4606-9ebf-\
8f015a01c8e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]Left", "  ", "=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"shiftLeft", ",", " ", "id2"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"shift", ",", " ", 
    RowBox[{"space", " ", "direction"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]Right", " ", "=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"shiftRight", ",", "id2"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"back", " ", "shift"}], ",", " ", 
    RowBox[{"space", " ", "direction"}]}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.790725800957137*^9, 3.790725819413659*^9}, {
   3.7907259247481527`*^9, 3.7907259344191384`*^9}, {3.7907260138587337`*^9, 
   3.790726042522909*^9}, {3.7907277743006907`*^9, 3.790727785123967*^9}, {
   3.7907281043527164`*^9, 3.7907281400785303`*^9}, 3.790728324391092*^9, {
   3.790728633088441*^9, 3.790728639168667*^9}, 3.790729067700674*^9, {
   3.7907292847929697`*^9, 3.7907292856404448`*^9}, {3.7907298039788785`*^9, 
   3.790729818961584*^9}, 3.790730098486212*^9, 3.7907304099310718`*^9, 
   3.7907305757942247`*^9, {3.7907306498712964`*^9, 3.7907306558395967`*^9}, {
   3.7907308157104783`*^9, 3.7907308191513433`*^9}, 3.7908688710652575`*^9, 
   3.790868945933421*^9, 
   3.7908690136588907`*^9},ExpressionUUID->"14d6ac3a-69e3-44fb-89ef-\
4288dd3e444a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shiftUp", "=", 
   RowBox[{"RotateLeft", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"KroneckerDelta", ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "T"}], "}"}]}], "]"}], "]"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"shift", ",", " ", 
    RowBox[{"time", " ", "only"}]}], " ", "*)"}]}], "\n", 
 RowBox[{"shiftDown", "=", 
  RowBox[{"RotateRight", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"KroneckerDelta", ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", "T"}], "}"}]}], "]"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"back", " ", "shift"}], ",", " ", 
    RowBox[{"time", " ", "only"}]}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.790725262612059*^9, 3.7907252934528675`*^9}, {
   3.79072560924139*^9, 3.79072561743929*^9}, {3.7907256554576373`*^9, 
   3.790725708190832*^9}, {3.7907257461112456`*^9, 3.7907257577979774`*^9}, 
   3.790726438268858*^9, {3.7907264868046875`*^9, 3.7907264881158733`*^9}, {
   3.790726527524377*^9, 3.790726551579423*^9}, {3.7907266167419186`*^9, 
   3.7907266388032064`*^9}, {3.7907268869469852`*^9, 3.7907269379343*^9}, {
   3.7907270248602924`*^9, 3.7907270304128437`*^9}, {3.790727238218734*^9, 
   3.7907272484813576`*^9}, {3.7907273507378254`*^9, 
   3.7907273986090837`*^9}, {3.7907274481463065`*^9, 
   3.7907274687984753`*^9}, {3.790727502753379*^9, 3.7907275186385098`*^9}, {
   3.7907275542533836`*^9, 3.790727603158004*^9}, {3.7907289166384315`*^9, 
   3.790728947012579*^9}, {3.7907290422114906`*^9, 3.7907290488593645`*^9}, {
   3.790729576149208*^9, 3.7907295798359194`*^9}, {3.790729678715579*^9, 
   3.790729687331235*^9}, {3.7907297706345615`*^9, 3.790729771561987*^9}, {
   3.7907300305193644`*^9, 3.7907300393189073`*^9}, {3.7907301093664646`*^9, 
   3.7907301302695*^9}, {3.7907301656455603`*^9, 3.7907301662531834`*^9}, 
   3.790888223341237*^9},ExpressionUUID->"164a28e1-7a7d-4aa9-8553-\
2b768c73de44"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]Up", "   ", "=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"id1", ",", "shiftUp"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"shift", ",", " ", 
    RowBox[{"time", " ", "direction"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]Down", " ", "=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"id1", ",", "shiftDown"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"back", " ", "shift"}], ",", " ", 
    RowBox[{"time", " ", "direction"}]}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.790725800957137*^9, 3.790725819413659*^9}, {
   3.7907259247481527`*^9, 3.7907259344191384`*^9}, {3.7907260138587337`*^9, 
   3.790726042522909*^9}, {3.7907277743006907`*^9, 3.790727785123967*^9}, {
   3.7907281043527164`*^9, 3.7907281400785303`*^9}, 3.790728324391092*^9, {
   3.790728633088441*^9, 3.790728639168667*^9}, 3.790729067700674*^9, {
   3.7907292847929697`*^9, 3.7907292856404448`*^9}, {3.7907298039788785`*^9, 
   3.790729818961584*^9}, {3.7907300591026373`*^9, 3.7907300605747247`*^9}, {
   3.7907301499572906`*^9, 3.790730181965439*^9}, {3.7907302503730135`*^9, 
   3.7907302581322017`*^9}, 3.7907304235306387`*^9, {3.790730639039013*^9, 
   3.790730646735241*^9}, {3.790730828774377*^9, 3.790730831886448*^9}, {
   3.7908690481416044`*^9, 
   3.790869078020552*^9}},ExpressionUUID->"9a8e5a3b-8a67-430d-9b1e-\
e084ab36d5a2"],

Cell["\<\
The orbit Jacobian is a  [L\[Times]T]\[RightArrow][L\[Times]T] matrix. \
\[LineSeparator]Mathematica makes this a block matrix of  [L\[Times]L] size, \
with each sub-block [T\[Times]T]:\
\>", "Text",
 CellChangeTimes->{{3.7907309876596293`*^9, 
  3.790731146042448*^9}},ExpressionUUID->"278ed121-7ea6-4e19-8bb9-\
4092655808ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[Sigma]Left", " ", "+", " ", "\[Sigma]Down", " ", "-", " ", 
    RowBox[{"2", "s", " ", "Kronecker2d"}], " ", "+", " ", "\[Sigma]Up", " ", 
    "+", " ", "\[Sigma]Right"}], ")"}], "//", "MatrixForm"}], "\n", 
 RowBox[{
  RowBox[{"\[ScriptCapitalJ]", "=", 
   RowBox[{"(", 
    RowBox[{"\[Sigma]Left", " ", "+", " ", "\[Sigma]Down", " ", "-", " ", 
     RowBox[{"2", "s", " ", "Kronecker2d"}], " ", "+", " ", "\[Sigma]Up", " ",
      "+", " ", "\[Sigma]Right"}], ")"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.790725800957137*^9, 3.790725819413659*^9}, {
   3.7907259247481527`*^9, 3.7907259344191384`*^9}, {3.7907260138587337`*^9, 
   3.790726042522909*^9}, {3.7907277743006907`*^9, 3.790727785123967*^9}, {
   3.7907281043527164`*^9, 3.7907281400785303`*^9}, 3.790728324391092*^9, {
   3.790728393425228*^9, 3.790728435091358*^9}, {3.7907287156012187`*^9, 
   3.790728745390727*^9}, {3.790728778984873*^9, 3.7907288047598743`*^9}, {
   3.790729316904044*^9, 3.7907293847589445`*^9}, {3.7907303265477777`*^9, 
   3.790730343859044*^9}, 3.790731429007039*^9, {3.79073196918451*^9, 
   3.7907319783848095`*^9}, {3.7908598104412317`*^9, 
   3.7908598147017407`*^9}, {3.790859923221142*^9, 3.7908599437586575`*^9}, {
   3.790865141877166*^9, 3.790865143757557*^9}, 3.790868900106803*^9, {
   3.7908689340717216`*^9, 3.7908689569524355`*^9}, {3.7908690062892404`*^9, 
   3.790869010101538*^9}, {3.790869041991757*^9, 3.790869045500292*^9}, {
   3.7908690810247126`*^9, 
   3.790869084045621*^9}},ExpressionUUID->"86a854bb-f274-4d40-9abc-\
bfbeaab24814"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ArrayFlatten", "[", "\[ScriptCapitalJ]", "]"}], "//", 
   "MatrixForm"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"just", " ", "to", " ", "have", " ", "a", " ", "look"}], ",", " ", 
    RowBox[{"but", " ", "//", 
     RowBox[{
     "MatrixForm", " ", "messes", " ", "up", " ", "next", " ", "step"}]}]}], 
   " ", "*)"}]}], "\n", 
 RowBox[{"\[ScriptCapitalJ]\[ScriptCapitalJ]", " ", "=", " ", 
  RowBox[{"ArrayFlatten", "[", "\[ScriptCapitalJ]", "]"}]}]}], "Code",
 CellChangeTimes->{{3.790731868506901*^9, 3.7907318805074635`*^9}, 
   3.790731961659174*^9, {3.7907320102490635`*^9, 3.7907320148242273`*^9}, 
   3.7907321561036882`*^9, {3.7908601405490837`*^9, 3.7908601554131002`*^9}, {
   3.790860381138163*^9, 
   3.7908604345974407`*^9}},ExpressionUUID->"0a3d15c2-228e-477e-ad86-\
9155cf5f62fe"],

Cell[TextData[{
 "In the L=4 and T=3 example this matrix has 12 column vectors. They are the \
fundamental parallelepiped basis vectors, and N",
 Cell[BoxData[
  FormBox[
   SubscriptBox["", 
    RowBox[{"[", 
     RowBox[{"L", "*", "T"}], "]"}]], TraditionalForm]],ExpressionUUID->
  "181f32fe-2fc0-488b-b258-ebd28946ca2a"],
 " = |det(\[ScriptCapitalJ])|"
}], "Text",
 CellChangeTimes->{{3.790731265280533*^9, 3.7907314030711174`*^9}, {
   3.7907314472787137`*^9, 3.7907314759741774`*^9}, 3.7907315185877657`*^9, {
   3.790731590264341*^9, 3.790731590792013*^9}, {3.790731624998812*^9, 
   3.790731667235634*^9}, {3.7907326636412525`*^9, 3.790732672952485*^9}, {
   3.7909364706860704`*^9, 
   3.7909364749983463`*^9}},ExpressionUUID->"78e45220-7fba-4d4f-987f-\
f901da951e08"],

Cell[BoxData[{
 RowBox[{"Abs", "[", 
  RowBox[{"Det", "[", "\[ScriptCapitalJ]\[ScriptCapitalJ]", "]"}], 
  "]"}], "\n", 
 RowBox[{"Factor", "[", 
  RowBox[{"Det", "[", "\[ScriptCapitalJ]\[ScriptCapitalJ]", "]"}], 
  "]"}]}], "Code",
 CellChangeTimes->{{3.7907317030274506`*^9, 3.7907317285146537`*^9}, 
   3.79073202017691*^9, {3.790790567989543*^9, 3.7907905757418556`*^9}, {
   3.7907923840371313`*^9, 3.7907923905880785`*^9}, {3.7908605048661933`*^9, 
   3.790860536474845*^9}},ExpressionUUID->"a1b7da19-99f4-4948-aefa-\
90db88246c03"],

Cell["\<\
All results are  in agreement with 2019-11-22 Han\[CloseCurlyQuote]s Fourier \
products of eigenvalues formula. \[LineSeparator]So we are done for \
rectangular Bravais cells.\
\>", "Text",
 CellChangeTimes->{{3.790732417706608*^9, 3.790732457405015*^9}, {
   3.7907324902106915`*^9, 3.7907324910211906`*^9}, {3.7907325294903584`*^9, 
   3.7907325523781796`*^9}, {3.7907325860453243`*^9, 3.790732642160559*^9}, {
   3.790732683018248*^9, 3.7907327055203094`*^9}, {3.790935942672495*^9, 
   3.790935970049121*^9}, 3.7909365011289606`*^9, {3.7909367927595005`*^9, 
   3.790936807056057*^9}, {3.7909512801918097`*^9, 
   3.7909513062721863`*^9}},ExpressionUUID->"df4f1b74-ef1a-4b53-ae38-\
c7e7a123c2e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "[L\[Times]T]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["", "S"], TraditionalForm]],ExpressionUUID->
  "01eee13d-8a03-44be-b276-0b9139ce65a0"],
 " relative-periodic Bravais cell"
}], "Section",
 CellChangeTimes->{{3.7909516656209445`*^9, 3.790951691899001*^9}, {
  3.7909517618065453`*^9, 3.790951789907098*^9}, {3.7909518270290327`*^9, 
  3.7909518300546885`*^9}},ExpressionUUID->"7dd07d37-3ba6-4c2e-9307-\
ecf9d65d7a28"],

Cell[TextData[{
 "\nConstruction of orbit Jacobian |det(\[ScriptCapitalJ]S)| for \
relative-periodic domains:\t                             coded Han 2020-02-17\
\n   \[ScriptCapitalJ]S(s) = (\[Sigma]LeftS + \[Sigma]DownS - 2s Kronecker2d \
+ \[Sigma]UpS + \[Sigma]RightS)\nShift S appended everyplace to indicate [L\
\[Times]T]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["", "S"], TraditionalForm]],ExpressionUUID->
  "08db3a49-f348-45d7-88bc-f272c54289df"],
 " Bravais relative-periodic cell.\[LineSeparator]The above rectangle case is \
the S=0 case of this computation."
}], "Text",
 CellChangeTimes->{{3.790904889389727*^9, 3.790904948526252*^9}, 
   3.790935947959868*^9, {3.7909512331021276`*^9, 3.790951246540539*^9}, {
   3.7909514798755803`*^9, 3.7909514813955793`*^9}, {3.7909515136966114`*^9, 
   3.79095160094237*^9}, {3.7909518052470355`*^9, 
   3.790951951632379*^9}},ExpressionUUID->"2ac3f1ea-824a-4733-b804-\
3c42cb28927f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]LeftS", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"l1", "+", "1"}], ",", "l2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"t1", ",", "t2"}], "]"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"l1", "-", 
          RowBox[{"(", 
           RowBox[{"L", "-", "1"}], ")"}]}], ",", "l2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"t1", ",", "t2"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l2", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "T"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t2", ",", "T"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]RightS", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"l1", "-", "1"}], ",", "l2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"t1", ",", "t2"}], "]"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"l1", "+", 
          RowBox[{"(", 
           RowBox[{"L", "-", "1"}], ")"}]}], ",", "l2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"t1", ",", "t2"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l2", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "T"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t2", ",", "T"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Shift", " ", "in", " ", "space", " ", "direction"}], " ", 
   "*)"}]}]}], "Code",
 CellChangeTimes->{{3.790905422813044*^9, 3.7909054594049797`*^9}, {
   3.790905521517235*^9, 3.790905523866426*^9}, {3.7909055665210733`*^9, 
   3.790905594917696*^9}, {3.790905645257098*^9, 3.790905647095283*^9}, {
   3.790906000016026*^9, 3.7909060849817944`*^9}, 3.790906828073337*^9, {
   3.7909075878615103`*^9, 3.7909076050793667`*^9}, {3.790935810269057*^9, 
   3.790935812260356*^9}, {3.790951073440607*^9, 
   3.7909510764978304`*^9}},ExpressionUUID->"30fe4c73-63f5-4f69-ac1e-\
9f232e19a478"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]DownS", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"l1", ",", "l2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"t1", "+", "1"}], ",", "t2"}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"l1", "-", "S"}], ",", "l2"}], "]"}], "+", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"l1", "-", "S", "+", "L"}], ",", "l2"}], "]"}]}], ")"}], 
       "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"t1", "+", "1", "-", "T"}], ",", "t2"}], "]"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l2", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "T"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t2", ",", "T"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]UpS", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"l1", ",", "l2"}], "]"}], "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"t1", "-", "1"}], ",", "t2"}], "]"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"l1", "+", "S"}], ",", "l2"}], "]"}], "+", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{
           RowBox[{"l1", "+", "S", "-", "L"}], ",", "l2"}], "]"}]}], ")"}], 
       "*", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{
         RowBox[{"t1", "-", "1", "+", "T"}], ",", "t2"}], "]"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l2", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "T"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t2", ",", "T"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Shift", " ", "in", " ", "time", " ", "direction"}], 
   "*)"}]}]}], "Code",
 CellChangeTimes->{{3.79090609526493*^9, 3.790906158271603*^9}, {
  3.79090632658854*^9, 3.7909063270661697`*^9}, {3.7909063651002073`*^9, 
  3.790906379394343*^9}, {3.790906425266489*^9, 3.790906476338361*^9}, {
  3.7909065811133747`*^9, 3.790906591672942*^9}, {3.790906643608872*^9, 
  3.790906652427602*^9}, {3.790906705421998*^9, 3.79090671101543*^9}, {
  3.790907613089911*^9, 3.790907616745041*^9}, {3.7909509819166813`*^9, 
  3.7909509867153225`*^9}},ExpressionUUID->"9fdc3576-913f-485a-8f38-\
95999aae31fa"],

Cell["\<\
With the relative periodic boundary, I don\[CloseCurlyQuote]t know a good way \
to write the shift operators as a Kronecker product of shifts in two \
directions...\
\>", "Text",
 CellChangeTimes->{{3.790904889389727*^9, 3.790904948526252*^9}, {
  3.790907633262391*^9, 3.790907738584545*^9}, {3.790908222363866*^9, 
  3.790908230109548*^9}},ExpressionUUID->"f34632b4-d070-4af3-a5ea-\
f7cf405faef8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[Sigma]LeftS", " ", "+", " ", "\[Sigma]DownS", " ", "-", " ", 
    RowBox[{"2", "s", " ", "Kronecker2d"}], " ", "+", " ", "\[Sigma]UpS", " ",
     "+", " ", "\[Sigma]RightS"}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalJ]S", "=", 
   RowBox[{"(", 
    RowBox[{"\[Sigma]LeftS", " ", "+", " ", "\[Sigma]DownS", " ", "-", " ", 
     RowBox[{"2", "s", " ", "Kronecker2d"}], " ", "+", " ", "\[Sigma]UpS", 
     " ", "+", " ", "\[Sigma]RightS"}], ")"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.7909068093786592`*^9, 3.790906857000599*^9}, {
  3.790907071700795*^9, 3.790907080711891*^9}, {3.790950990503984*^9, 
  3.7909510192760468`*^9}},ExpressionUUID->"d0948ff4-87e3-448c-8652-\
8b482a5c7479"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ArrayFlatten", "[", "\[ScriptCapitalJ]S", "]"}], "//", 
   "MatrixForm"}], " "}], "\n", 
 RowBox[{"\[ScriptCapitalJ]\[ScriptCapitalJ]S", " ", "=", " ", 
  RowBox[{"ArrayFlatten", "[", "\[ScriptCapitalJ]S", "]"}]}]}], "Code",
 CellChangeTimes->{{3.790906896664736*^9, 3.790906909614455*^9}, {
  3.7909069684564238`*^9, 3.790906973846603*^9}, {3.790907038154508*^9, 
  3.790907043267373*^9}, {3.790907086924782*^9, 3.790907089130237*^9}, {
  3.7909510309492755`*^9, 
  3.790951040224571*^9}},ExpressionUUID->"adb901b7-0157-4379-b700-\
f4a1dbf19f43"],

Cell[TextData[{
 "N",
 Cell[BoxData[
  FormBox[
   SubscriptBox["", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"L", "*", "T"}], "]"}], "_S"}]], TraditionalForm]],
  ExpressionUUID->"76566919-62dd-47bb-ad63-9ce525674764"],
 " = |det(\[ScriptCapitalJ]S)|"
}], "Text",
 CellChangeTimes->{{3.790731265280533*^9, 3.7907314030711174`*^9}, {
   3.7907314472787137`*^9, 3.7907314759741774`*^9}, 3.7907315185877657`*^9, {
   3.790731590264341*^9, 3.790731590792013*^9}, {3.790731624998812*^9, 
   3.790731667235634*^9}, {3.7907326636412525`*^9, 3.790732672952485*^9}, {
   3.790907830087483*^9, 3.790907844073016*^9}, {3.7909366762257752`*^9, 
   3.7909367081784925`*^9}, 
   3.790951044368314*^9},ExpressionUUID->"a191499b-c84f-4244-8c7e-\
6fac88533711"],

Cell[BoxData[{
 RowBox[{"Abs", "[", 
  RowBox[{"Det", "[", "\[ScriptCapitalJ]\[ScriptCapitalJ]S", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "[", 
  RowBox[{"Det", "[", "\[ScriptCapitalJ]\[ScriptCapitalJ]S", "]"}], 
  "]"}]}], "Code",
 CellChangeTimes->{{3.7909069430383863`*^9, 3.79090694327304*^9}, {
  3.790907855049952*^9, 3.790907876775543*^9}, {3.790908029166675*^9, 
  3.790908036086095*^9}, {3.790936073783583*^9, 3.7909361077059326`*^9}, {
  3.79095105878188*^9, 
  3.7909510659332542`*^9}},ExpressionUUID->"22c59fc5-3022-45fc-8b89-\
e04dbcfe0953"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"check", " ", "1"}], ":", " ", 
    RowBox[{
     RowBox[{"agrees", " ", "with", " ", "the", " ", "Fourier"}], "-", 
     RowBox[{"diagonilization", " ", "counting", " ", "formula"}]}], ":"}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Factor", "[", 
    RowBox[{"Product", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"s", "*", "2"}], "-", 
       RowBox[{"2", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "Pi", " ", 
          RowBox[{"n1", " ", "/", "L"}]}], "]"}]}], "-", 
       RowBox[{"2", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", "Pi", " ", 
           RowBox[{"n2", " ", "/", "T"}]}], " ", "-", 
          RowBox[{"2", " ", "Pi", " ", "S", " ", 
           RowBox[{"n1", " ", "/", 
            RowBox[{"(", 
             RowBox[{"T", " ", "L"}], ")"}]}]}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n2", ",", "T"}], "}"}]}], "]"}], "]"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"check", " ", "2"}], ":", " ", 
      RowBox[{"works", " ", "correctly", " ", "for", " ", "S"}]}], "=", "0"}],
     ",", " ", "ie", ",", " ", 
    RowBox[{"the", " ", "rectangle", " ", "case", " ", "as", " ", "well"}]}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"check", " ", "3"}], ":", " ", 
      RowBox[{"works", " ", "correctly", " ", "for", " ", "S"}]}], "=", "L"}],
     ",", " ", "ie", ",", " ", 
    RowBox[{"S", "=", 
     RowBox[{"0", " ", "mod", " ", "L", " ", "checks"}]}]}], " ", 
   "*)"}]}]], "Code",
 CellChangeTimes->{{3.7909069430383863`*^9, 3.79090694327304*^9}, {
   3.790907855049952*^9, 3.790907876775543*^9}, {3.790908029166675*^9, 
   3.790908036086095*^9}, {3.790936073783583*^9, 3.7909361440115156`*^9}, 
   3.7909362663024435`*^9, {3.7909363700477886`*^9, 3.7909363748006887`*^9}, {
   3.7909368561751056`*^9, 3.7909368626793776`*^9}, {3.7909375322372446`*^9, 
   3.7909375426168118`*^9}, {3.790937589449005*^9, 3.7909376295167723`*^9}, {
   3.7909508109978633`*^9, 3.7909508220630703`*^9}, {3.7909509174377584`*^9, 
   3.790950931695285*^9}},ExpressionUUID->"ae97eb8b-68a7-45a5-b49d-\
b91141184ffc"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{900, 1268},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 14, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3b47a2c6-53e7-41ca-bd36-a88bfa92be1c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 230, 4, 96, "Title",ExpressionUUID->"65f12e0a-663c-4829-a857-62b949ad3f96"],
Cell[813, 28, 1811, 37, 156, "Text",ExpressionUUID->"2c3bd703-ec2a-4f13-97d2-4b28b1b2f855"],
Cell[CellGroupData[{
Cell[2649, 69, 160, 3, 67, "Section",ExpressionUUID->"f9c16f3e-8403-4a1b-801e-966d591591f7"],
Cell[2812, 74, 2816, 41, 78, "Text",ExpressionUUID->"fecd480d-d6d8-4eca-8c1c-061fb6f6f9fe"],
Cell[5631, 117, 3816, 67, 87, "Code",ExpressionUUID->"01e184e3-95dd-4225-9e91-96da952069ac"],
Cell[9450, 186, 929, 24, 105, "Code",ExpressionUUID->"5868847f-71e8-4d37-87e0-32df9c8285d4"],
Cell[10382, 212, 1376, 29, 69, "Code",ExpressionUUID->"d36b6388-c035-486f-94ff-80bcdcfd5dda"],
Cell[11761, 243, 1100, 20, 50, "Code",ExpressionUUID->"b7598e2d-628f-495f-86d8-66686c3125eb"],
Cell[12864, 265, 1810, 37, 69, "Code",ExpressionUUID->"ac514317-f813-4606-9ebf-8f015a01c8e7"],
Cell[14677, 304, 1388, 29, 69, "Code",ExpressionUUID->"14d6ac3a-69e3-44fb-89ef-4288dd3e444a"],
Cell[16068, 335, 1931, 38, 69, "Code",ExpressionUUID->"164a28e1-7a7d-4aa9-8553-2b768c73de44"],
Cell[18002, 375, 1452, 30, 69, "Code",ExpressionUUID->"9a8e5a3b-8a67-430d-9b1e-e084ab36d5a2"],
Cell[19457, 407, 337, 7, 56, "Text",ExpressionUUID->"278ed121-7ea6-4e19-8bb9-4092655808ec"],
Cell[19797, 416, 1603, 27, 69, "Code",ExpressionUUID->"86a854bb-f274-4d40-9abc-bfbeaab24814"],
Cell[21403, 445, 858, 19, 69, "Code",ExpressionUUID->"0a3d15c2-228e-477e-ad86-9155cf5f62fe"],
Cell[22264, 466, 777, 17, 58, "Text",ExpressionUUID->"78e45220-7fba-4d4f-987f-f901da951e08"],
Cell[23044, 485, 538, 11, 69, "Code",ExpressionUUID->"a1b7da19-99f4-4948-aefa-90db88246c03"],
Cell[23585, 498, 710, 12, 56, "Text",ExpressionUUID->"df4f1b74-ef1a-4b53-ae38-c7e7a123c2e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24332, 515, 441, 11, 67, "Section",ExpressionUUID->"7dd07d37-3ba6-4c2e-9307-ecf9d65d7a28"],
Cell[24776, 528, 941, 18, 122, "Text",ExpressionUUID->"2ac3f1ea-824a-4733-b804-3c42cb28927f"],
Cell[25720, 548, 2598, 68, 195, "Code",ExpressionUUID->"30fe4c73-63f5-4f69-ac1e-9f232e19a478"],
Cell[28321, 618, 2965, 82, 195, "Code",ExpressionUUID->"9fdc3576-913f-485a-8f38-95999aae31fa"],
Cell[31289, 702, 409, 8, 56, "Text",ExpressionUUID->"f34632b4-d070-4af3-a5ea-f7cf405faef8"],
Cell[31701, 712, 795, 16, 69, "Code",ExpressionUUID->"d0948ff4-87e3-448c-8652-8b482a5c7479"],
Cell[32499, 730, 595, 12, 69, "Code",ExpressionUUID->"adb901b7-0157-4379-b700-f4a1dbf19f43"],
Cell[33097, 744, 750, 18, 36, "Text",ExpressionUUID->"a191499b-c84f-4244-8c7e-6fac88533711"],
Cell[33850, 764, 574, 12, 69, "Code",ExpressionUUID->"22c59fc5-3022-45fc-8b89-e04dbcfe0953"],
Cell[34427, 778, 2335, 59, 105, "Code",ExpressionUUID->"ae97eb8b-68a7-45a5-b49d-b91141184ffc"]
}, Open  ]]
}, Open  ]]
}
]
*)

